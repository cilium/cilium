# Automatically generated by Makefile. DO NOT EDIT
---
metadata:
  name: query-dns-policy
  labels:
    name: query-dns-policy
    topology: any
    component: proxy-check
    traffic: internal
    quarantine: "false"
    type: tool
spec:
  template:
    metadata:
      labels:
        name: query-dns-policy
    spec:
      hostNetwork: false
      containers:
      - name: query-dns-policy-container
        ports: []
        image: cilium/demo-client
        imagePullPolicy: IfNotPresent
        command:
        - /bin/sh
        - -c
        - while true; do dig +noall +question +answer +timeout=1 +tries=1 www.google.com
          && sleep 1 ; done
        readinessProbe:
          timeoutSeconds: 7
          exec:
            command:
            - "true"
        livenessProbe:
          timeoutSeconds: 7
          exec:
            command:
            - "true"
  selector:
    matchLabels:
      name: query-dns-policy
  replicas: 1
apiVersion: apps/v1
kind: Deployment
---
metadata:
  name: query-dns-policy
  labels:
    name: query-dns-policy
    topology: any
    component: proxy-check
    traffic: internal
    quarantine: "false"
    type: tool
spec:
  endpointSelector:
    matchLabels:
      name: query-dns-policy
  egress:
  - toPorts:
    - ports:
      - port: "53"
        protocol: ANY
      rules:
        dns:
        - matchPattern: '*'
    toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: kube-dns
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: kube-system
        k8s:k8s-app: node-local-dns
  - toPorts:
    - ports:
      - port: "5353"
        protocol: UDP
      rules:
        dns:
        - matchPattern: '*'
    toEndpoints:
    - matchLabels:
        k8s:io.kubernetes.pod.namespace: openshift-dns
        k8s:dns.operator.openshift.io/daemonset-dns: default
apiVersion: cilium.io/v2
kind: CiliumNetworkPolicy

