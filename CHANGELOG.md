# Changelog

## v1.17.0-rc.1

Summary of Changes
------------------

**Minor Changes:**
* envoy: Use yaml format for bootstrap config (Backport PR cilium/cilium#36781, Upstream PR cilium/cilium#36820, @sayboras)
* vendor: Bump gateway-api version to v1.2.1 (Backport PR cilium/cilium#36781, Upstream PR cilium/cilium#36773, @sayboras)

**Bugfixes:**
* envoy: Configure internal address config based on IP family (Backport PR cilium/cilium#36781, Upstream PR cilium/cilium#36733, @sayboras)

**CI Changes:**
* [v1.17] gh: replace kernel development trees with 6.12 kernel (cilium/cilium#36841, @julianwiedmann)
* gha: Disable envoy version check in upgrade/downgrade tests (Backport PR cilium/cilium#36739, Upstream PR cilium/cilium#36734, @sayboras)
* github: Fix branch name in build-go-caches.yaml (cilium/cilium#36906, @michi-covalent)

**Misc Changes:**
* chore(deps): update all github action dependencies (v1.17) (cilium/cilium#36759, @cilium-renovate[bot])
* chore(deps): update all-dependencies (v1.17) (cilium/cilium#36724, @cilium-renovate[bot])
* chore(deps): update all-dependencies (v1.17) (cilium/cilium#36849, @cilium-renovate[bot])
* chore(deps): update dependency cilium/cilium-cli to v0.16.23 (v1.17) (cilium/cilium#36894, @cilium-renovate[bot])
* chore(deps): update docker.io/library/golang:1.23.4 docker digest to 7ea4c9d (v1.17) (cilium/cilium#36848, @cilium-renovate[bot])
* chore(deps): update helm/kind-action action to v1.12.0 (v1.17) (cilium/cilium#36837, @cilium-renovate[bot])
* chore(deps): update kindest/node docker tag to v1.29.12 (v1.17) (cilium/cilium#36758, @cilium-renovate[bot])
* chore(deps): update stable lvh-images (v1.17) (patch) (cilium/cilium#36722, @cilium-renovate[bot])
* chore(deps): update stable lvh-images (v1.17) (patch) (cilium/cilium#36836, @cilium-renovate[bot])
* doc: fix typo on kubeproxy-free (CEV -> CVE) (Backport PR cilium/cilium#36739, Upstream PR cilium/cilium#36701, @alagoutte)
* ingress, gateway-api: Convert test fixtures to file based (Backport PR cilium/cilium#36781, Upstream PR cilium/cilium#36732, @sayboras)
* ingress, gateway-api: Convert test fixtures to file based (Backport PR cilium/cilium#36781, Upstream PR cilium/cilium#36810, @sayboras)
* Remove reference to DNS polling (Backport PR cilium/cilium#36739, Upstream PR cilium/cilium#36679, @JacobHenner)
* vendor: bump ebpf-go to 0.17 (Backport PR cilium/cilium#36781, Upstream PR cilium/cilium#36723, @ti-mo)

**Other Changes:**
* [v1.17] gha: use /test to trigger tests in stable branches (cilium/cilium#36690, @giorio94)
* install: Update image digests for v1.17.0-rc.0 (cilium/cilium#36693, @cilium-release-bot[bot])

## v1.17.0-rc.0

Summary of Changes
------------------

**Major Changes:**
* Add support for pod level Networking QoS classes with BW Manager and FQ (cilium/cilium#36025, @hemanthmalla)
* bgp: remove metallb bgp integration. (cilium/cilium#36191, @harsimran-pabla)
* CLI: cilium upgrade preserve prev config (cilium/cilium#36347, @saiaunghlyanhtet)
* HTTP policies are now supported on port ranges. (cilium/cilium#36056, @jrajahalme)

**Minor Changes:**
* Add option for user-supplied Envoy bootstrap configmaps in helm chart (cilium/cilium#35597, @byxorna)
* Adds the ability to add labels to external CIDRs for policy selection and Hubble flows. (cilium/cilium#36087, @squeed)
* Allow delegated IPAM to specify uplink interface (cilium/cilium#34779, @ruicao93)
* Batch processing of Service and EndpointSlices up to 200 milliseconds to merge repeated changes to a single Service. This significantly reduces the amount of processing Cilium performs for Services with many EndpointSlices. (cilium/cilium#36466, @joamaki)
* BGP: Introducing metrics for tracking health of BGP subsystem reconcile loop (cilium/cilium#36369, @harsimran-pabla)
* bpffs: Use defaults.BPFFSRoot to distinguish default/custom BPF FS mount location (cilium/cilium#36150, @rastislavs)
* CFP: Egress Gateway Additional NodeSelectors (cilium/cilium#35421, @chaunceyjiang)
* cilium-cli: Derive the default version from cilium/charts (cilium/cilium#36344, @michi-covalent)
* ciliumidentity: Fixes missing enqueue time tracker entries (cilium/cilium#36548, @ovidiutirla)
* docs, daemon: Deprecate high-scale ipcache mode (cilium/cilium#36373, @pchaigno)
* docs: Remove cassandra and memcached examples (cilium/cilium#36477, @joestringer)
* Documentation: Add more details regarding svc lb map sizing. (cilium/cilium#36217, @tommyp1ckles)
* endpoint: Add an option to lock endpoints down (that is, drop all traffic) when their policy maps overflow. (cilium/cilium#35042, @nathanjsweet)
* envoy: Bump cilium-envoy to latest version (cilium/cilium#36295, @sayboras)
* hive/metrics: Fix flaky test (cilium/cilium#36418, @ovidiutirla)
* k8s: Bump k8s to v1.32.0 (cilium/cilium#36534, @sayboras)
* k8s: Bump k8s to v1.32.rc-2 (cilium/cilium#36412, @sayboras)
* operator: Add more common metrics to operator (kvstore, rate-limiting, version) (cilium/cilium#36014, @odinuge)
* service: Cap number of backends included in monitor message (cilium/cilium#36394, @joamaki)
* The agent now tries to deduplicate the strings and maps holding Kubernetes labels and annotations to reduce overall memory consumption. (cilium/cilium#36294, @joamaki)

**Bugfixes:**
* Address potential connectivity disruption when using either L7 / DNS Network policies in combination with per-endpoint routes and hostLegacyRouting, or L7 / DNS network policies in combination with IPsec network encryption. (cilium/cilium#36484, @julianwiedmann)
* bgpv2: Do not fail if PeerAddress is not configured for a peer (cilium/cilium#36488, @rastislavs)
* Cilium no longer keeps old DNS-IP mappings alive while reaping newer ones, leading to spurious drops in connections to domains with many IPs associated. (cilium/cilium#36252, @bimmlerd)
* cilium: LB source ranges fixes (cilium/cilium#36517, @borkmann)
* DNS proxy port is no longer released when endpoint with a DNS policy fails to regenerate successfully. A potential deadlock between CEC/CCEC parser and endpoint policy update is removed. (cilium/cilium#36142, @jrajahalme)
* Do not leak ipcache entries when apiserver entities are cluster external (cilium/cilium#35868, @hemanthmalla)
* eni.subnetTagsFilter and eni.instanceTagsFilter are now templated to comma separated string (cilium/cilium#36617, @sderoe)
* Fix connectivity issue caused by stale cilium eBPF program when using --bpf-filter-priority (cilium/cilium#36176, @tamilmani1989)
* gateway-api: Fix gateway checks for namespace (cilium/cilium#35452, @sayboras)
* helm: avoid setting bpf-lb-sock-terminate-pod-connections (cilium/cilium#36508, @ysksuzuki)
* metrics/features: remove reporting metrics' defaults by default (cilium/cilium#36298, @aanm)
* Restore the original flag semantics for --egress-masquerade-interfaces to the same as v1.17.0-pre.2 or earlier (cilium/cilium#36504, @viktor-kurchenko)
* sysctlfix: close systemd config file before triggering reload (cilium/cilium#36368, @dylandreimerink)
* ui: drop CORS headers from api response (cilium/cilium#35762, @geakstr)

**CI Changes:**
* .github/workflows: Enable DualStack for conformance-kind-proxy-embedded (cilium/cilium#36398, @dylandreimerink)
* ariane: don't run tests for renovate config changes (cilium/cilium#36543, @tklauser)
* bpf/tests: test ipv6 udp packets when redirecting from l3 to l2 (cilium/cilium#36536, @rgo3)
* ci/ipsec: Cilium agents in ci-ipsec-e2e no longer share host's boot ID (cilium/cilium#35951, @jschwinger233)
* ci: add network policy scale test (cilium/cilium#35278, @marseel)
* ci: configure connectivity test in delegated ipam e2e (cilium/cilium#36475, @wedaly)
* ci: datapath-verifier: also run on 6.12 kernel (cilium/cilium#36619, @julianwiedmann)
* ci: fix job names for various ci workflows (cilium/cilium#36397, @marseel)
* cilium-cli/connectivity: disable warning log checks before v1.17 (cilium/cilium#36358, @giorio94)
* cilium-cli/connectivity: fix IPv6 feature check for 2ndary node IPv6 (cilium/cilium#36513, @tklauser)
* Fix cilium CLI connectivity tests in IPv6-only clusters. (cilium/cilium#36026, @wedaly)
* gh: conformance-clustermesh: test with IPsec + BPF NodePort (cilium/cilium#36384, @julianwiedmann)
* gh: e2e-upgrade: add coverage for 6.12 kernel (cilium/cilium#36640, @julianwiedmann)
* gh: e2e-upgrade: add coverage for 6.6 kernel (cilium/cilium#36626, @julianwiedmann)
* gh: e2e-upgrade: de-renovate the config example (cilium/cilium#36463, @julianwiedmann)
* gha: always collect and upload sysdump if 100 nodes scale test fails (cilium/cilium#36367, @giorio94)
* gha: always respect the given image-tag in the helm-default action (cilium/cilium#36293, @giorio94)
* gha: configure environment in build-images-base/image-digests job (cilium/cilium#36318, @giorio94)
* gha: default the helm-default image-tag also in pull request workflows (cilium/cilium#36314, @giorio94)
* gha: Enable parallel requests for L7 tests (cilium/cilium#36623, @sayboras)
* gha: extra Cilium agents CPU and Mem metrics in clustermesh scale test (cilium/cilium#36481, @giorio94)
* gha: Use ubuntu-24.04 for integration-test (cilium/cilium#36628, @sayboras)
* Quarantine of high-scale IPcache (cilium/cilium#36376, @Artyop)
* test/k8s: remove unused migrate-svc manifests (cilium/cilium#36388, @tklauser)
* Update oss-fuzz CI workflow (cilium/cilium#36472, @joestringer)

**Misc Changes:**
* .gitattributes: Syntax highlight bpftrace script (cilium/cilium#36512, @pchaigno)
* .github/workflows: do not fail ginkgo if unable to fetch features (cilium/cilium#36461, @aanm)
* .github: fix conformance-k8s NP test (cilium/cilium#36355, @aanm)
* Add documentation for feature metrics (cilium/cilium#36579, @aanm)
* Add Kakao to USERS.md (cilium/cilium#36630, @gyutaeb)
* Add policy-related features tracking in Cilium agent as prometheus metrics (cilium/cilium#36203, @aanm)
* Add test for generation and extraction of debug symbols. Add debug symbol support for gdb. (cilium/cilium#36515, @EricMountain)
* Add the tls:// prefix in the Hubble TLS doc (cilium/cilium#36410, @liyihuang)
* Add versioning to drop notify events. (cilium/cilium#35413, @sypakine)
* api: silence warning if API response failed due to connection closed (cilium/cilium#36332, @giorio94)
* bgp: remove metallb-bgp documentation (cilium/cilium#36306, @harsimran-pabla)
* bpf: add host_wg_encrypt hook (cilium/cilium#36266, @rgo3)
* bpf: Avoid implicit shorten-64-to-32 in clang 19 (cilium/cilium#36186, @sayboras)
* bpf: host: exit early when to-host handles to-proxy traffic (cilium/cilium#36395, @julianwiedmann)
* bpf: host: minor cleanups (cilium/cilium#36574, @julianwiedmann)
* bpf: host: misc improvements for cil_from_netdev() / cil_from_host() (cilium/cilium#36360, @julianwiedmann)
* bpf: host: remove unused code in handle_netdev() (cilium/cilium#36328, @julianwiedmann)
* bpf: nodeport: forward L7 svc traffic straight to proxy (cilium/cilium#36383, @julianwiedmann)
* bpf: proxy: cleanup ctx_redirect_to_proxy_first_tproxy() (cilium/cilium#36382, @julianwiedmann)
* bpf: proxy: split out the TPROXY parts from ctx_redirect_to_proxy_first() (cilium/cilium#36327, @julianwiedmann)
* build(deps): bump tornado from 6.4.1 to 6.4.2 in /Documentation (cilium/cilium#36586, @dependabot[bot])
* Bump github.com/mdlayher/arp to latest, adjust usage (cilium/cilium#36571, @tklauser)
* Bump StateDB to v0.3.4 and refactor db command usages (cilium/cilium#36325, @joamaki)
* certloader: prevent panic when Watcher.Stop is called multiple times (cilium/cilium#36366, @devodev)
* chore(deps): update all github action dependencies (main) (cilium/cilium#36439, @cilium-renovate[bot])
* chore(deps): update all github action dependencies (main) (cilium/cilium#36501, @cilium-renovate[bot])
* chore(deps): update all github action dependencies (main) (cilium/cilium#36605, @cilium-renovate[bot])
* chore(deps): update all lvh-images main (main) (patch) (cilium/cilium#36436, @cilium-renovate[bot])
* chore(deps): update all lvh-images main (main) (patch) (cilium/cilium#36606, @cilium-renovate[bot])
* chore(deps): update all-dependencies (main) (cilium/cilium#36316, @cilium-renovate[bot])
* chore(deps): update all-dependencies (main) (cilium/cilium#36440, @cilium-renovate[bot])
* chore(deps): update all-dependencies (main) (cilium/cilium#36499, @cilium-renovate[bot])
* chore(deps): update cilium/cilium-cli action to v0.16.22 (main) (cilium/cilium#36500, @cilium-renovate[bot])
* chore(deps): update dependency cilium/cilium-cli to v0.16.21 (main) (cilium/cilium#36420, @cilium-renovate[bot])
* chore(deps): update dependency cilium/cilium-cli to v0.16.22 (main) (cilium/cilium#36514, @cilium-renovate[bot])
* chore(deps): update docker.io/library/golang:1.23.4 docker digest to 7003184 (main) (cilium/cilium#36604, @cilium-renovate[bot])
* chore(deps): update go to v1.23.4 (main) (cilium/cilium#36437, @cilium-renovate[bot])
* chore(deps): update quay.io/cilium/cilium-envoy docker tag to v1.31.3-1733229491-16e43f505747e9351d9e96927f02d72eecffa3e4 (main) (cilium/cilium#36348, @cilium-renovate[bot])
* chore(deps): update quay.io/cilium/cilium-envoy docker tag to v1.31.4-1733710912-e119b3d3cbe9727886d0a502a5dcfc3d55acbe58 (main) (cilium/cilium#36453, @cilium-renovate[bot])
* chore(deps): update quay.io/cilium/cilium-envoy docker tag to v1.31.4-1734096493-fff09f16c2c269b22509c86dfc1d3e8f52eb3857 (main) (cilium/cilium#36607, @cilium-renovate[bot])
* Cilium-cli connectivity test now supports use of parallel requests with curl (cilium/cilium#35949, @jrajahalme)
* cilium: Dump supported svc annotations (cilium/cilium#36353, @borkmann)
* cilium: streamline lb mode config to lb alg (cilium/cilium#36297, @borkmann)
* CODEOWNERS: Add feature owners for masquerade (cilium/cilium#36378, @joestringer)
* CODEOWNERS: create new group hubble-metrics (cilium/cilium#35991, @rectified95)
* Connecticity tests with L7 policies and port ranges are skipped on Cilium releases prior to 1.17. (cilium/cilium#36460, @jrajahalme)
* connectivity: run client-egress-to-cidrgroup-deny conditionally (cilium/cilium#36426, @aanm)
* contrib: suppress noop taint removal (cilium/cilium#36539, @nebril)
* daemon: disable dependent bpf-sock-lb options if bpf-sock-lb=false (cilium/cilium#36396, @tklauser)
* datapath/linux: Fix neighbor table index conversions (cilium/cilium#36429, @rastislavs)
* datapath/linux: Remove device's neighbors upon device deletion (cilium/cilium#36424, @rastislavs)
* datapath/tables: Add Neighbor statedb table and populate it in Devices Controller (cilium/cilium#36317, @rastislavs)
* Decouple orchestrator from the local node store multicast stream (cilium/cilium#36331, @pippolo84)
* defaults: bump FQDN max ips per host (cilium/cilium#36255, @bimmlerd)
* docs: Add missing default identity label in the description of identity-relevant labels' example (cilium/cilium#36558, @liyihuang)
* docs: Clarify the behavior of CiliumNetworkPolicies toCIDRSet (cilium/cilium#36549, @verysonglaa)
* docs: Fix typo in multi-pool section title (cilium/cilium#36305, @joestringer)
* docs: system-requirements: require 5.4 kernel (cilium/cilium#36386, @julianwiedmann)
* Don't mark KVstoreLeaseTTL flag as hidden (cilium/cilium#36380, @hemanthmalla)
* Endpoint populate new policymap early if empty (cilium/cilium#36361, @jrajahalme)
* endpoint: stop regenerating all endpoints on every identity allocation; switch to periodic regens instead. (cilium/cilium#35815, @squeed)
* Ensure debug symbols are generated for the debug image even when stripping symbols for the release image. (cilium/cilium#36417, @EricMountain)
* envoy: Pass tofqdns-proxy-response-max-delay to Envoy (cilium/cilium#36330, @jrajahalme)
* envoy: remove incorrect comments (cilium/cilium#36385, @tklauser)
* envoy: update to latest version (cilium/cilium#36622, @mhofstetter)
* experimental: ShadowInstances from many sources (cilium/cilium#35810, @DamianSawicki)
* fix(deps): update all go dependencies main (main) (cilium/cilium#36272, @cilium-renovate[bot])
* fix(deps): update all go dependencies main (main) (cilium/cilium#36454, @cilium-renovate[bot])
* fix(deps): update all go dependencies main (main) (cilium/cilium#36550, @cilium-renovate[bot])
* fix(deps): update aws-sdk-go-v2 monorepo (main) (cilium/cilium#36438, @cilium-renovate[bot])
* fix(deps): update module golang.org/x/crypto to v0.31.0 [security] (main) (cilium/cilium#36529, @cilium-renovate[bot])
* fix: set netpol disablement values before disabling CEP (cilium/cilium#36339, @jshr-w)
* images: Use cilium-builder image instead of golang to build hubble (cilium/cilium#35697, @learnitall)
* ipcache: Remove metric for idempotent operations (cilium/cilium#35367, @joestringer)
* Isolate node-to-node encryption tests to wireguard (cilium/cilium#36556, @ldelossa)
* k8s: Bump k8s to v1.32.rc-1 (cilium/cilium#36352, @sayboras)
* lock: Remove StoppableWaitGroup.Done(), return done function from Add() (cilium/cilium#35892, @joamaki)
* Lower interval for icmp probes and stop on first success (cilium/cilium#36400, @marseel)
* maglev: Cleanup implementation (cilium/cilium#35885, @joamaki)
* make: Fix kind-image-fast-agent (cilium/cilium#36545, @brb)
* make: Fix kind-image-fast-agent from scratch (cilium/cilium#36587, @joestringer)
* make: Update cilium-bugtool upon fast target (cilium/cilium#36516, @brb)
* metrics/features: enable ClusterMesh (cilium/cilium#36402, @aanm)
* metrics: Sample metrics periodically and dump samples as part of sysdump (cilium/cilium#35916, @joamaki)
* Miscellaneous improvements and fixes concerning the endpoints UID checks and surrounding logic (cilium/cilium#36392, @giorio94)
* Miscellaneous improvements to the etcd ListAndWatch implementation (cilium/cilium#36091, @giorio94)
* node: remove refresh parameter from NodeNeighborRefresh (cilium/cilium#36319, @mhofstetter)
* nodemanager: cleanup clusternodesclient (cilium/cilium#36315, @mhofstetter)
* pkg/endpoint: delete unused const backupDirectorySuffix in directory.go (cilium/cilium#36601, @Sm0ckingBird)
* Policy: move ingestion to cell, batch updates (cilium/cilium#36044, @squeed)
* Prepare for release v1.17.0-pre.3 (cilium/cilium#36300, @cilium-release-bot[bot])
* Prepare v1.17 stable branch (cilium/cilium#36627, @aanm)
* promise: Replace go routine with `context.AfterFunc` (cilium/cilium#36185, @gandro)
* proxy: Take proxy port reference for new redirects immediately (cilium/cilium#36435, @jrajahalme)
* proxyports: Resolve data races in test (cilium/cilium#36399, @jrajahalme)
* proxyports: Sleep a bit longer in tests (cilium/cilium#36389, @jrajahalme)
* README: Update releases (cilium/cilium#36304, @aanm)
* renovate: do not pin digest for helm/kind-action (cilium/cilium#36459, @aanm)
* renovate: re-enable updates for github.com/mdlayher/arp (cilium/cilium#36542, @tklauser)
* Update documentation for egress masquerading behavior (cilium/cilium#36267, @liyihuang)
* Update Service Mesh Makefile targets (cilium/cilium#36350, @youngnick)
* Use bash syntax to consume env variable (cilium/cilium#36544, @ferozsalam)

