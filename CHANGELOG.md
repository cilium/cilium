# Changelog

## v1.7.9

Summary of Changes
------------------

**Bugfixes:**
* Fix v1.7.7 upgrade, add flags to help hitless upgrade from v1.6.x to v1.7.x (#13038, @joestringer)
* pkg/kvstore: set endpoint shuffle in etcd client connectivity (Backport PR #13041, Upstream PR #12943, @aanm)

**Misc Changes:**
* docs: Mention L7 limitation in Calico chaining GSG (Backport PR #13041, Upstream PR #13005, @pchaigno)
* doc: Document seamless upgrade process for remote-node identity change (#13042, @tgraf)

## v1.7.8

Summary of Changes
------------------

**Major Changes:**
* Cilium operator HA mode (Backport PR #12760, Upstream PR #12409, @fristonio)

**Minor Changes:**
* daemon: Add hidden --k8s-sync-timeout option (Backport PR #12873, Upstream PR #12822, @joestringer)
* fix: node-init restartPods should use docker if /etc/crictl.yaml not found (Backport PR #12992, Upstream PR #12894, @UnwashedMeme)
* k8s: update k8s versions to 1.17.11 (#12877, @aanm)
* v1.7: Make EC2 AWS API endpoint configurable in operator (#12896, @tklauser)

**Bugfixes:**
* avoid schedule cilium-operator pods in same node for HA mode (Backport PR #12760, Upstream PR #12771, @aanm)
* datapath: Fix ICMP ECHO tuple ports (Backport PR #12760, Upstream PR #12729, @brb)
* datapath: Pull skb data in to-netdev path (Backport PR #12992, Upstream PR #12917, @brb)
* Fix bug in ENI environments where connections to NodePort would fail due to asymmetric routing (Backport PR #13010, Upstream PR #12770, @qmonnet)
* Fix bug where cilium-health reports connectivity failures to stale IPs (Backport PR #13002, Upstream PR #12989, @kkourt)
* Istio integration has been updated to Istio release 1.5.9. (Backport PR #12873, Upstream PR #12861, @jrajahalme)
* operator: Fix non-leader crashing with kvstore (Backport PR #12838, Upstream PR #12825, @christarazi)
* pkg/kvstore: add gRPC keep alives for etcd connectivity (Backport PR #12992, Upstream PR #12947, @aanm)
* Fix packet loss issues when running Cilium v1.6 and v1.7 in the same cluster concurrently with --enable-remote-node-identity=false (#12999, @joestringer)

**CI Changes:**
* test: Add externalIPs tests to K8sServicesTest and disable K8sKubeProxyFreeMatrix (Backport PR #12800, Upstream PR #11696, @brb)

**Misc Changes:**
* Add Kubernetes compatibility documentation (Backport PR #12800, Upstream PR #12783, @aanm)
* doc: update #ebpf Slack channel name (Backport PR #12800, Upstream PR #12766, @qmonnet)
* docs/metrics: Correct label typos in metrics.rst (Backport PR #12992, Upstream PR #12901, @sayboras)
* docs: limit copybutton to content area only (Backport PR #13002, Upstream PR #12997, @genbit)
* Stop waiting for pod when collecting logs (Backport PR #12800, Upstream PR #12547, @Weil0ng)
* Upgrade Cilium docs theme version (Backport PR #13002, Upstream PR #12996, @Neelajacques)
* v1.7 doc: hubble namespace fix for GKE (#12966, @kAworu)
* v1.7: Update Go to 1.13.15 (#12812, @tklauser)
* vagrant: Don't use the NFS device's IP as node IP (Backport PR #13002, Upstream PR #12215, @pchaigno)

## v1.7.7

Summary of Changes
------------------

**Minor Changes:**
* Add an option to cilium-agent for disabling 'HealthCheckNodePort' (Backport PR #12458, Upstream PR #11236, @soumynathan)
* Add heartbeat to etcd quorum check (Backport PR #12534, Upstream PR #12453, @tgraf)
* Atomically replace endpoint header files to avoid corrupted or inconsistent state. (Backport PR #12399, Upstream PR #12380, @tklauser)
* DNS Proxy is started earlier in the Cilium agent bootstrap to make it available to running endpoints sooner. (#12718, @jrajahalme)
* Improve etcd fail-over scenarios (Backport PR #12534, Upstream PR #12427, @tgraf)
* k8s: update k8s dependencies to 1.17.9 (#12668, @aanm)
* operator: rate limit GC of security identities (Backport PR #12450, Upstream PR #12451, @aanm)
* Parallelise CRD registration to improve bootstrap time (Backport PR #12727, Upstream PR #12719, @tgraf)
* Fix issue where Cilium could crash on startup with "can't create perf event: no such device". (Backport PR #12459, Upstream PR #12068, @tklauser)

**Bugfixes:**
* bpf: explicitly set ttl in tunnel key (Backport PR #12613, Upstream PR #12529, @borkmann)
* bpf: Fix monitor aggregation for 'from-network' (Backport PR #12613, Upstream PR #12559, @joestringer)
* cilium: chaining mode skb->mark can be mangled by iptables allow opt-out (Backport PR #12458, Upstream PR #12185, @jrfastab)
* cilium: fix helm usage of enableIdentityMap -> enableIdentityMark (Backport PR #12458, Upstream PR #12194, @jrfastab)
* datapath/linux: protect against concurrent access in NodeValidateImplementation (Backport PR #12613, Upstream PR #12461, @tklauser)
* etcd: Fix firstSession error handling (Backport PR #12774, Upstream PR #12773, @tgraf)
* etcd: Fix session renewal controllers (Backport PR #12613, Upstream PR #12553, @tgraf)
* etcd: Fix several etcd related issues (Backport PR #12622, Upstream PR #12605, @tgraf)
* Fix etcd failure behavior when user or client context ends (Backport PR #12613, Upstream PR #12587, @tgraf)
* Fix manual endpoint regeneration via command line (Backport PR #12613, Upstream PR #12524, @christarazi)
* Fix string slice type CLI arguments (Backport PR #12613, Upstream PR #12457, @JieJhih)
* Fix toGroups CRD to address validation errors (Backport PR #12622, Upstream PR #12440, @lbernail)
* install/kubernetes: re-add removed permissions from clusterrole (#12720, @aanm)
* pkg/k8s: use copy of objectmeta when fetching from local stores (Backport PR #12613, Upstream PR #12470, @aanm)
* Protect ENI and Azure IPAM from misbehaving cloud APIs (Backport PR #12337, Upstream PR #11231, @tgraf)

**CI Changes:**
* .travis:fix up TestShuffle failure on Arm64 (Backport PR #12613, Upstream PR #12515, @Jianlin-lv)
* Extend FQDN test to validate DNS proxy during restart (#12739, @christarazi)
* fqdn/dnsproxy/proxy_test: increase again timeout for DNS TCP exchanges (Backport PR #12723, Upstream PR #12606, @qmonnet)

**Misc Changes:**
* Adds documentation for limiting identity-relevant labels used when evaluating Cilium Identities (Backport PR #12622, Upstream PR #12517, @seanmwinn)
* backporting: Report progress in set-labels.py (Backport PR #12723, Upstream PR #12640, @pchaigno)
* Clarify egress policy rule documentation (Backport PR #12613, Upstream PR #12525, @joestringer)
* contrib: Add ability to pass suffix for branch (Backport PR #12458, Upstream PR #12351, @christarazi)
* contrib: fix branch check in `start-backport` script (Backport PR #12458, Upstream PR #12361, @Rolinh)
* contrib: Fix submit-backport PR set-labels detection (Backport PR #12723, Upstream PR #11912, @joestringer)
* contrib: Print PR number in set-labels.py (Backport PR #12723, Upstream PR #12704, @christarazi)
* contrib: Tighten search for list of PRs (Backport PR #12723, Upstream PR #12703, @christarazi)
* dnsproxy: Use restored Endpoints before Endpoints are available (#12731, @jrajahalme)
* docs(identity): Correct discrepancy between label and descriptions (Backport PR #12723, Upstream PR #12639, @sayboras)
* docs(troubleshooting): Remove bugtool related step with --serve flag (Backport PR #12613, Upstream PR #12532, @sayboras)
* docs: add instructions for vX.Y helm charts (Backport PR #12458, Upstream PR #12291, @aanm)
* fqdn/dnsproxy: set SO_REUSEPORT on listening socket (#12728, @tklauser)
* ipcache: Fix unit test flake (#12734, @joestringer)
* Rework netns handling in LinuxRoutingSuite privileged tests (Backport PR #12613, Upstream PR #11620, @christarazi)
* test: bump k8s libraries to 1.17.8 (#12418, @aanm)
* Update Go to 1.13.14 (#12586, @tklauser)

**Other Changes:**
* etcd: Disable heartbeat quorum check by default (#12755, @tgraf)
* test/bpf: use `nproc --all` instead of `nproc -all` (#12401, @tklauser)

## v1.7.6

Summary of Changes
------------------

**Minor Changes:**
* Add possibility to configure native-routing-cidr in helm chart. (Backport PR #12354, Upstream PR #11132, @zbindenren)

**Bugfixes:**
* Avoid having endpoints in 'restoring' state in case the connectivity with the KVStore is not reliable (Backport PR #12333, Upstream PR #12307, @aanm)
* bpf: Use `nproc --all` for __NR_CPUS__ (Backport PR #12363, Upstream PR #12121, @gandro)
* cilium: fix encryption flow labels in ip6 case (Backport PR #12056, Upstream PR #12015, @jrfastab)
* Fix bug where etcd session renew would block indefinitely, causing endpoint provision to fail (Backport PR #12333, Upstream PR #12292, @joestringer)
* Fix bug where identity allocation wouldn't cancel from api timeouts (Backport PR #12350, Upstream PR #12328, @joestringer)
* Fix setting monitorAggregationLevel to max reflects via CLI (Backport PR #12333, Upstream PR #12014, @soumynathan)
* Fix silent cilium monitor on systems with offline CPUs (Backport PR #12363, Upstream PR #12310, @pchaigno)
* Fix syslog hook missing in DefaultLogger (Backport PR #12333, Upstream PR #12170, @ArthurChiao)
* helm/operator: fix IPv6 liveness probe address for operator (Backport PR #12333, Upstream PR #12223, @Rolinh)
* iptables: Remove '--nowildcard' from socket match (Backport PR #12333, Upstream PR #12248, @jrajahalme)
* Istio integration is updated to Istio release 1.5.6. (Backport PR #12333, Upstream PR #12214, @jrajahalme)
* Istio integration is updated to Istio release 1.5.7. (Backport PR #12357, Upstream PR #12353, @jrajahalme)
* make: fix LOCKDEBUG env variable reference for docker-plugin-image (Backport PR #12333, Upstream PR #12318, @Rolinh)
* option: Require native-routing-cidr only if IPv4 is enabled (Backport PR #12354, Upstream PR #12198, @brb)
* policy/api: Add reserved:health entity (Backport PR #12333, Upstream PR #12199, @pchaigno)
* Stop Cilium from hanging on CNP or CCNP events from Kubernetes if running with 'k8s-event-handover=true' and 'kvstore=""' (Backport PR #12333, Upstream PR #12146, @aanm)
* The host proxy is updated to Envoy release 1.13.3 (Backport PR #12350, Upstream PR #12343, @jrajahalme)
* Valid CNP and CCNP 'matchLabel' values must be 63 characters or less and must be empty or begin and end with an alphanumeric character ([a-z0-9A-Z]) with dashes (-), underscores (_), dots (.), and alphanumerics between. (Backport PR #12354, Upstream PR #12117, @aanm)

**CI Changes:**
* fqdn/dnsproxy/proxy_test: increase timeout for DNS TCP client exchanges (Backport PR #12333, Upstream PR #12305, @qmonnet)
* ginkgo-ext: Fix data-race in Writer (Backport PR #12333, Upstream PR #12025, @gandro)
* test: Add retries to curl command (Backport PR #12357, Upstream PR #11993, @christarazi)
* test: Download correct cilium-istioctl for the executing OS. (Backport PR #12357, Upstream PR #12109, @jrajahalme)
* test: Skip Istio test if Ginkgo runs on unsupported runtime. (Backport PR #12357, Upstream PR #11905, @jrajahalme)

**Misc Changes:**
* k8s: update k8s libraries to v1.17.7 (#12208, @aanm)
* contrib: Add environment variable to script  to control K8s namespace (Backport PR #12333, Upstream PR #12082, @christarazi)
* contrib: Misc. fixups for k8s-cilium-exec.sh script (Backport PR #12333, Upstream PR #12126, @christarazi)
* doc: Misc fixups for Transparent Encryption GSG (Backport PR #12333, Upstream PR #12088, @christarazi)
* doc: revamp kata containers getting started guide (Backport PR #12362, Upstream PR #12144, @Rolinh)
* docs: point cilium docs into a stable version of sphinx theme (Backport PR #11992, Upstream PR #12010, @genbit)
* docs: re-design cilium docs theme (Backport PR #11992, Upstream PR #11803, @genbit)
* Fix GKE Helm options for CI and docs. (Backport PR #12333, Upstream PR #12087, @jrajahalme)
* Fix native routing cidr missing flag in daemon (Backport PR #12354, Upstream PR #12180, @aanm)
* logo: change SVG file used for the logo (Backport PR #11992, Upstream PR #12002, @qmonnet)
* test: Remove ginkgo linux dependency (Backport PR #12357, Upstream PR #12074, @jrajahalme)
* Update xargs usage in restart-pods documentation (Backport PR #12333, Upstream PR #12064, @ap4y)
* Use right schema when validating CCNP in pre-flight upgrade step (Backport PR #12354, Upstream PR #12106, @aanm)
* Dockerfile: Bump cilium-runtime image (#12371, @christarazi)
* fqdn: Fix panic on MarshalJSON (#12224, @tklauser)

## v1.7.5

Summary of Changes
------------------

**Minor Changes:**
* Add "--iptables-lock-timeout" to configure iptables --wait parameter (Backport PR #11855, Upstream PR #11701, @joestringer)
* bump k8s dependencies to v1.15.12, v1.16.10 and v1.17.6 (#11680, @aanm)
* cilium: Add CLI to introspect IP <-> Identity cache (Backport PR #11630, Upstream PR #11566, @joestringer)
* connectivity-check: Do not perform hostport in standard check (Backport PR #11855, Upstream PR #11715, @tgraf)
* daemon: Clarify log msg how to use only TCP socket-lb (Backport PR #11971, Upstream PR #11918, @brb)
* Envoy is updated to release 1.13.2. (Backport PR #12009, Upstream PR #11973, @jrajahalme)
* Support DNS matchPattern="*" to match "." (Backport PR #11855, Upstream PR #11633, @joestringer)

**Bugfixes:**
* 'identity does not exist' warning messages are not logged if the allocation attempt is not at max (#11580, @djboris9)
* Avoid duplication of generated toCIDRs when using a toServices based CNP (or CCNP) (Backport PR #11971, Upstream PR #11901, @aanm)
* datapath: Accept proxy traffic if enable-endpoint-routes are enabled (Backport PR #11855, Upstream PR #11819, @tgraf)
* datapath: Only NOTRACK proxy return traffic going to Cilium datapath (Backport PR #11971, Upstream PR #11899, @jrajahalme)
* endpoint: Fix data races while accessing GetIdentity() (Backport PR #11971, Upstream PR #11941, @tgraf)
* envoy: Take xds mutator lock for map access (Backport PR #11630, Upstream PR #11541, @jrajahalme)
* etcd: Increase status check timeout to 10 seconds (Backport PR #11855, Upstream PR #11750, @tgraf)
* Fix issue when Cilium randomly stops doing service translation in k8s 1.18 (Backport PR #12019, Upstream PR #11947, @aanm)
* Fix issue where Cilium-agent fails to start on nodes without a default gateway (Backport PR #11855, Upstream PR #11632, @soumynathan)
* Fix issue where traffic from a pod could be dropped despite allow policy when DNS L7 rules are used (Backport PR #11855, Upstream PR #11764, @joestringer)
* Fix leaking endpoint state metric (Backport PR #11930, Upstream PR #11884, @christarazi)
* Fix pre-flight deployment for users upgrading from < 1.7 (Backport PR #11630, Upstream PR #11599, @aanm)
* fix transparent encryption related bugs (Backport PR #12019, Upstream PR #11974, @jrfastab)
* IPAM related bugfixes (Backport PR #11766, Upstream PR #10587, @tgraf)
* ipcache: Fix deadlock when ipcache GC results in datapath reload (Backport PR #11971, Upstream PR #11950, @tgraf)
* Istio integration has been updated to Istio release 1.5.4 (Backport PR #11630, Upstream PR #11530, @jrajahalme)
* Properly cancel endpoint creations as they become obsolete (Backport PR #11971, Upstream PR #11920, @tgraf)
* proxy: Do not decrement proxy port reference count when reverting. (Backport PR #11855, Upstream PR #11753, @jrajahalme)
* proxy: Keep DNS port allocated (Backport PR #11855, Upstream PR #11661, @jrajahalme)
* service: Fix wrong localEndpoints count in HealthCheckNodePort (Backport PR #11906, Upstream PR #11863, @gandro)

**CI Changes:**
* ci: Change vagrant timeout mechanism (Backport PR #11906, Upstream PR #11858, @nebril)
* cilium, test: Only run sockops tests on 4.19 and bpf-next kernels (Backport PR #12019, Upstream PR #11998, @jrfastab)
* Fix flaky assertion on metrics (Backport PR #11971, Upstream PR #11966, @christarazi)
* test: Add simple retries for flaky Helm operations (Backport PR #11906, Upstream PR #11762, @christarazi)

**Misc Changes:**
* [v1.7] Dockerfile: Bump cilium-runtime to latest image (#11628, @joestringer)
* agent: Fix data race when accessing d.monitorAgent (Backport PR #11855, Upstream PR #11823, @tgraf)
* Also garbage collect Azure IPAM routes on endpoint removal (Backport PR #11630, Upstream PR #11452, @bpineau)
* contrib/backporting: remove requires-janitor-review label (Backport PR #12031, Upstream PR #11986, @aanm)
* Correct cidr input in linuxRouting.NewRoutingInfo (Backport PR #11855, Upstream PR #11569, @sayboras)
* docs: Include directions to restart pods in the k3s install guide (Backport PR #11906, Upstream PR #11879, @seanmwinn)
* envoy: Include detail in NACK warning (Backport PR #12031, Upstream PR #12016, @jrajahalme)
* etcd: propagate Context from higher-level calls (Backport PR #12019, Upstream PR #11891, @tklauser)
* Fix various data races in pkg/aws/eni and pkg/ipam (Backport PR #11766, Upstream PR #11685, @christarazi)
* install: Fix erroneous comment (Backport PR #11855, Upstream PR #11603, @joestringer)
* iptables: carry on and log on failure to set up transient rules (Backport PR #12031, Upstream PR #12006, @qmonnet)
* policy: Fix rule translation test flake (Backport PR #11971, Upstream PR #11913, @joestringer)
* proxy: release redir.mutex on early exit, update a comment on mutex use (Backport PR #11855, Upstream PR #11666, @qmonnet)
* Retry on conflicts when creating/updating CiliumNode objects on agent startup (Backport PR #11909, Upstream PR #11673, @ashrayjain)
* service: Clean up HealthCheckNodePort server when traffic policy changes (Backport PR #12019, Upstream PR #11952, @gandro)
* Shorten dummy device name in linuxrouting tests (Backport PR #11630, Upstream PR #11555, @christarazi)
* Update Go to 1.13.12 (#11813, @tklauser)

**Other Changes:**
* [v1.7] install: Remove IPAM setting (#11592, @joestringer)

## v1.7.4

Summary of Changes
------------------

**Major Changes:**
* Switch to native-routing in GKE guide (Backport PR #11233, Upstream PR #11079, @tgraf)

**Minor Changes:**
* helm: add bpf-policy-map-max option (Backport PR #11524, Upstream PR #11478, @alex1989hu)
* Istio integration has been updated to release 1.5.2 (Backport PR #11312, Upstream PR #11280, @jrajahalme)
* policymap, fragmap: clean up doc, map size configuration (Backport PR #11233, Upstream PR #10964, @qmonnet)
* Properly tear down gops agent on shutdown (Backport PR #11524, Upstream PR #11471, @tklauser)

**Bugfixes:**
* Auto detect EndpointSlice support by checking enabled APIs in Kubernetes. (Backport PR #11233, Upstream PR #11206, @Weil0ng)
* BPF: fix missing "break" in nat46 switch, and minor cleanup (Backport PR #11441, Upstream PR #11410, @qmonnet)
* bpf: Preserve source identity for hairpin via stack (Backport PR #11239, Upstream PR #10926, @tgraf)
* datapath/iptables: Masquerade hairpin traffic that traversed the stack (Backport PR #11239, Upstream PR #10928, @tgraf)
* Fix Docker getting started guide example. (Backport PR #11233, Upstream PR #11023, @tklauser)
* Fix fromCIDR policy on kernels 4.10 or older and extend test coverage (Backport PR #11414, Upstream PR #11333, @willdeuschle)
* Fix issue where cilium-health cannot healthcheck remote endpoint in ENI mode (Backport PR #11233, Upstream PR #11073, @christarazi)
* k8s: Do not send DeleteService event upon DeleteEndpoints (Backport PR #11488, Upstream PR #11467, @brb)
* k8s: Provide fallback for EndpointSlices detection if discovery API is not available (Backport PR #11233, Upstream PR #11253, @tgraf)
* pkg/k8s: add missing support for multi-stack (Backport PR #11459, Upstream PR #11240, @aanm)
* Remove stale rules for endpoints upon deletion in ENI mode (Backport PR #11441, Upstream PR #11163, @christarazi)
* set explicit liveness/readiness probe timeout for deny connectivity checks (Backport PR #11441, Upstream PR #10581, @danwent)
* Setting the agent.sleepAfterInit helm chart value to True will correctly configure the agent to sleep after Init (Backport PR #11441, Upstream PR #11203, @seanmwinn)

**Misc Changes:**
* cilium: add NodePortBindProtection to allow for opting out bind rejection (Backport PR #11233, Upstream PR #11188, @borkmann)
* daemon: set k8s options as soon as possible (Backport PR #11233, Upstream PR #11101, @aanm)
* dns: Log WriteMsgIP details. (Backport PR #11233, Upstream PR #11037, @jrajahalme)
* doc: Fix the kubectl create option in upgrade.rst (Backport PR #11441, Upstream PR #11271, @soumynathan)
* doc: Update EKS documentation to delete aws-node (Backport PR #11441, Upstream PR #10461, @errordeveloper)
* Docs policy title rename (Backport PR #11441, Upstream PR #10854, @danwent)
* Docs:  Update EKS GSG to clarify deployment in ENI vs. overlay mode (Backport PR #11441, Upstream PR #11068, @danwent)
* docs: Cilium multi-node (and mesh) Kind Guide (Backport PR #11441, Upstream PR #11157, @dctrwatson)
* docs: clarify recommendation around managing multiple policy types (Backport PR #11441, Upstream PR #11343, @genbit)
* docs: de-duplicate AWS cluster scale up instructions (Backport PR #11441, Upstream PR #10175, @tklauser)
* docs: Pin Hubble version to v0.5 branch (Backport PR #11233, Upstream PR #11121, @gandro)
* envoy: Reduce logging verbosity. (Backport PR #11441, Upstream PR #11349, @jrajahalme)
* Improve Helm post-setup NOTES (Backport PR #11488, Upstream PR #11269, @soumynathan)
* k8s/watchers: do not consider pods with empty podIPs (Backport PR #11459, Upstream PR #11282, @aanm)
* Refactor enirouting package to reduce code interdependence and add test coverage (Backport PR #11441, Upstream PR #11208, @christarazi)
* Use GO_VERSION as single source for the used Go version (Backport PR #11441, Upstream PR #10163, @tklauser)
* v1.7 Backport backporting scripts (#11451, @christarazi)
* Validate when Cilium is in ENI mode that IPv4 is enabled (Backport PR #11441, Upstream PR #11328, @soumynathan)

## v1.7.3

Summary of Changes
------------------

**Minor Changes:**
* bump k8s dependencies and test to v1.17.5 (#11046, @aanm)
* helm: add option to enable automatic etcd name resolution (Backport PR #11109, Upstream PR #10918, @aanm)
* Istio integration is simplified with Cilium build of istioctl. (Backport PR #10966, Upstream PR #10851, @jrajahalme)
* pkg/logging: redirect klog output to logrus (Backport PR #11109, Upstream PR #10961, @aanm)

**Bugfixes:**
* bpf: fix nodeport to avoid sending loopback address out to wire (Backport PR #10884, Upstream PR #10841, @borkmann)
* CRD: fix allocation logic of identities with the same set of labels (Backport PR #11109, Upstream PR #11040, @aanm)
* daemon: Fatal on startup when Identity CRD is enabled without k8s (Backport PR #11109, Upstream PR #11015, @raybejjani)
* daemon: Fix the "close of closed channel" panic (Backport PR #11200, Upstream PR #11056, @Sen666666)
* datapath: Fix wrong rev-NAT xlation due to stale conntrack entry (Backport PR #11109, Upstream PR #10984, @brb)
* Do not depend on `KUBERNETES_SERVICE_HOST` nor `KUBERNETES_SERVICE_PORT` environment variables to detect if cilium is running in k8s mode (Backport PR #11109, Upstream PR #11021, @aanm)
* Do not skip datapath rewrites when an otherwise duplicate endpoint regeneration requires it. (Backport PR #11038, Upstream PR #10949, @jrajahalme)
* endpoint: Avoid transient drops during policy map update (Backport PR #11038, Upstream PR #10936, @jrajahalme)
* Fix issue where --enable-remote-node-identity=false causes policy drops (Backport PR #11038, Upstream PR #11006, @joestringer)
* Log more information for error 'Unable update CRD identity information with a reference for this node' (Backport PR #10966, Upstream PR #10923, @aanm)
* Restore node IP behavior of Cilium < 1.7 (Backport PR #11109, Upstream PR #11057, @tgraf)

**CI Changes:**
* ci: bump 4.19 image version (Backport PR #10966, Upstream PR #10722, @nebril)
* ci: fix argument retrieval script for kernel specific builds on master (Backport PR #10966, Upstream PR #10932, @nebril)
* ci: increase vm memory in kernel specific build (Backport PR #10966, Upstream PR #10916, @nebril)
* Fix node ip script path (Backport PR #10966, Upstream PR #10685, @nebril)
* Run tests on 4.19 kernel (Backport PR #10966, Upstream PR #10634, @nebril)
* test: Install Helm 3 (Backport PR #11109, Upstream PR #10378, @jrajahalme)
* test: Run kubectl in test VM for older K8s releases (Backport PR #11109, Upstream PR #11072, @jrajahalme)

**Misc Changes:**
* Add helm NOTES to the root folder (Backport PR #11109, Upstream PR #10902, @soumynathan)
* bpf: remap MARK_MAGIC_SNAT_DONE marker to avoid conflicts (Backport PR #11109, Upstream PR #11008, @borkmann)
* Clarify CRI-O installation (Backport PR #10966, Upstream PR #10920, @aanm)
* expand 1.7.x upgrade guide on enable-remote-node-identity (Backport PR #10966, Upstream PR #10853, @danwent)
* Makefile: Fix --yaml arg for microk8s (Backport PR #10884, Upstream PR #10839, @joestringer)
* Update Go to 1.13.10 (#10911, @tklauser)

## v1.7.2

Summary of Changes
------------------

**Minor Changes:**
* Add helm NOTES file (Backport PR #10818, Upstream PR #10641, @soumynathan)
* Add option to retrieve pprof traces from running cilium-agents (Backport PR #10756, Upstream PR #10666, @aanm)
* bpf: significantly improve capacity of TCP CT tables (Backport PR #10818, Upstream PR #10518, @borkmann)
* Docs: Implements Documentation to install Cilium on k3s (Backport PR #10591, Upstream PR #10476, @seanmwinn)
* Istio integration has been updated to release 1.5.0. (Backport PR #10591, Upstream PR #10564, @jrajahalme)
* Istio integration is updated to release 1.5.1, with backported fix for GKE/COS. (Backport PR #10813, Upstream PR #10730, @jrajahalme)
* k8s: Disable several CiliumEndpoint status sections by default (Backport PR #10756, Upstream PR #10490, @tgraf)
* Keep Cluster IP service handling when accessed from pods when kubeProxyReplacement is set to "disabled" (pre-v1.6 behavior). (Backport PR #10657, Upstream PR #10651, @brb)
* Protect NodePort port range by appending it to net.ipv4.ip_local_reserved_ports if the range clashes with ephemeral port range (Backport PR #10833, Upstream PR #10782, @brb)
* Update k8s libraries to 1.17.4 (#10663, @aanm)

**Bugfixes:**
* cilium: encryption, additional mtu fix for non-default 1500B MTU (Backport PR #10632, Upstream PR #10551, @jrfastab)
* cilium: set encrypt node route mtu in encryption table (Backport PR #10756, Upstream PR #10741, @jrfastab)
* cni: fix interface sandbox in cmdAdd return value (Backport PR #10591, Upstream PR #10482, @jaffcheng)
* Do not throw errors for each new endpoint that is created (Backport PR #10756, Upstream PR #10608, @aanm)
* eni: Fix unexpected IP release when agent restarts (Backport PR #10756, Upstream PR #9888, @jaffcheng)
* Fix eks restart pods helm (Backport PR #10591, Upstream PR #10351, @tom-hadlaw-hs)
* Fix issue where lxc_config.h header disappears after some regenerations (Backport PR #10632, Upstream PR #10630, @joestringer)
* Fix possible endpoint restore failure in CRD mode. (Backport PR #10818, Upstream PR #10785, @aanm)
* Improve pod restarts on GKE (Backport PR #10591, Upstream PR #10377, @ap4y)
* k8s: Defer marking node as ready to just API is served (Backport PR #10818, Upstream PR #10767, @tgraf)
* Kubernetes connectivity check fixes (Backport PR #10818, Upstream PR #10801, @tgraf)
* kubernetes: do not set enable-endpoint-health-checking=false with portmap (Backport PR #10756, Upstream PR #10566, @soumynathan)
* pkg/monitor: Add missing drop reasons (Backport PR #10591, Upstream PR #10554, @Frankkkkk)
* policy: Keep NameManager locked during SelectorCache operations (Backport PR #10530, Upstream PR #10501, @jrajahalme)
* pre-flight: Correct tofqdns-precache container name (Backport PR #10756, Upstream PR #10753, @raybejjani)
* Tight CNP and CCNP schema validation for badly formatted policies (yaml or json) (Backport PR #10833, Upstream PR #10727, @aanm)
* When running in Kubernetes, Cilium will run a periodic heartbeat and close all open Kubernetes client connections if the active connections become unresponsive. (Backport PR #10756, Upstream PR #10184, @tom-hadlaw-hs)

**CI Changes:**
* [CI] Replace jenkinsfiles with symlinks (Backport PR #10591, Upstream PR #10262, @nebril)
* CI: K8sKafkaPolicyTest kafka-broker starts up without errors (Backport PR #10756, Upstream PR #10721, @raybejjani)
* pkg/k8s: fix heartbeat unit test (Backport PR #10818, Upstream PR #10790, @aanm)
* test: fix k8s provisioning with feature gates (Backport PR #10756, Upstream PR #10658, @aanm)
* test: Fix possible race in waitForNPods helper function (Backport PR #10591, Upstream PR #10481, @brb)
* test: Fix some minor microk8s integration issues (Backport PR #10632, Upstream PR #10577, @joestringer)

**Misc Changes:**
* Adds details about required kernel versions above 4.9.17, supported OS update (Backport PR #10756, Upstream PR #10537, @seanmwinn)
* bpf: do not drop unknown protos in nat handling (Backport PR #10591, Upstream PR #10526, @borkmann)
* cilium, contrib: tighten permissions on systemd bpffs mount unit file (Backport PR #10818, Upstream PR #10805, @borkmann)
* datapath: Do not log if svc is not found (Backport PR #10756, Upstream PR #10668, @brb)
* doc: Make Helm version requirements harder to miss, add notes on Helm 2+3 compatibility (Backport PR #10591, Upstream PR #10479, @errordeveloper)
* doc: Upgrade MarkupSafe to 1.1.1 (Backport PR #10591, Upstream PR #10579, @mrostecki)
* docs: A few cosmetic improvements in GKE guide (Backport PR #10591, Upstream PR #10550, @errordeveloper)
* Docs: Add step for mounting bpf filesystem on k3s installations (Backport PR #10591, Upstream PR #10508, @seanmwinn)
* docs: Clarify wording for cluster and init entities (Backport PR #10591, Upstream PR #10536, @joestringer)
* docs: fix bird dashboard image scale (Backport PR #10591, Upstream PR #10480, @aanm)
* docs: Improve policy visibility docs (Backport PR #10632, Upstream PR #10597, @joestringer)
* docs: Update SIG meeting notes (Backport PR #10591, Upstream PR #10519, @joestringer)
* Fix incorrect name in sysctl_linux_test.go (Backport PR #10818, Upstream PR #10729, @christarazi)
* Helm-charts: Fix the values.yaml comment that was misleading (Backport PR #10591, Upstream PR #10515, @soumynathan)
* helm: re-generate quick-install.yml after PR #10566 (Backport PR #10756, Upstream PR #10694, @tklauser)
* Improve k8s client heartbeat capability (Backport PR #10756, Upstream PR #10673, @aanm)
* make: pick up all privileged tests in `make tests-privileged` (Backport PR #10756, Upstream PR #10734, @tklauser)
* pkg/k8s: fix heartbeat unit test flake (Backport PR #10756, Upstream PR #10690, @aanm)
* Streamline upgrade docs (Backport PR #10657, Upstream PR #10505, @joestringer)
* test: Fix kubectl log retrieval for badLogMessages (Backport PR #10833, Upstream PR #10717, @pchaigno)
* Update Go to 1.13.9 (#10652, @tklauser)

**Other Changes:**
* helm: Remove dsr option leftover from values.yaml (#10800, @brb)

## v1.7.1

Summary of Changes
------------------

**Minor Changes:**
* add getting started guide for BIRD (Backport PR #10401, Upstream PR #10326, @ArthurChiao)
* bpf: Fix native dev cleanup (Backport PR #10401, Upstream PR #10352, @brb)
* Do not listen on any port by default for cilium-operator (#10370, @aanm)
* docs: Drop k8s 1.10 from supported/tested versions (Backport PR #10354, Upstream PR #10319, @jrajahalme)
* docs: Mention that a kv-store is optional with k8s. (Backport PR #10354, Upstream PR #10321, @jrajahalme)
* Fallback mode for a missing `xt_socket` kernel module is added where kernel's IP early demux functionality is disabled. This fallback is enabled by default if it is needed for correct policy enforcement and visibility functionality. This fallback may be disabled by setting `enable-xt-socket-fallback=false`. (Backport PR #10354, Upstream PR #10299, @jrajahalme)
* Switch to upstream bpftool (Backport PR #10429, Upstream PR #10353, @mrostecki)
* The deprecated `--enable-legacy-service` option was removed. (Backport PR #10286, Upstream PR #10255, @tklauser)

**Bugfixes:**
* AKS: Fix dynamic reconfiguration of bridge mode (Backport PR #10401, Upstream PR #10383, @tgraf)
* cilium: encryption, segfaults if existing non-Cilium xfrm policy without mark set exists (Backport PR #10286, Upstream PR #10268, @jrfastab)
* cilium: fix node-port range parsing from helm and update docs (Backport PR #10401, Upstream PR #10382, @borkmann)
* clustermesh: Emit identity-change events for remote clusters (Backport PR #10354, Upstream PR #10290, @raybejjani)
* Correct accidental partial revert of https://github.com/cilium/cilium/pull/10185 when reporting cluster status. (#10303, @raybejjani)
* daemon: fix cilium-agent helper message for disable-cnp-status-updates (Backport PR #10441, Upstream PR #10414, @aanm)
* doc: Fix AKS guide regression (Backport PR #10354, Upstream PR #10308, @tgraf)
* Envoy fixes for CVE-2020-8659, CVE-2020-8660, CVE-2020-8661, CVE-2020-8664 (Backport PR #10441, Upstream PR #10434, @jrajahalme)
* etcd: Fix gRPC load balancer issue (Backport PR #10401, Upstream PR #10381, @tgraf)
* Fixups for Correct clustermesh identity sync kvstore backend usage (Backport PR #10286, Upstream PR #10243, @raybejjani)
* fqdn: DNS proxy compresses DNS responses (Backport PR #10441, Upstream PR #10366, @raybejjani)
* kubernetes: do not disable node routes for portmap (Backport PR #10441, Upstream PR #10415, @aanm)
* Make cilium bpf {ct, nat} {list, flush} to work when running in ipv6-only mode (Backport PR #10254, Upstream PR #10193, @brb)
* metrics: add missing metrics for cilium agent api handler (Backport PR #10401, Upstream PR #10376, @fristonio)
* node: Remove permanent ARP entry when remote node is deleted (Backport PR #10354, Upstream PR #10227, @brb)
* policy: fix innermap's flag error in eppolicymap (Backport PR #10254, Upstream PR #10201, @zhiyuan0x)
* service: Fix HealthCheckNodePort not displayed in API (Backport PR #10254, Upstream PR #10240, @gandro)

**CI Changes:**
* test: Wait for Istio POD termination before deleting istio-system or cilium (Backport PR #10354, Upstream PR #10325, @jrajahalme)

**Misc Changes:**
* [1.7] docs: Simplify upgrade instructions (#10467, @joestringer)
* bpf: Fix typo in max options for bpf_lb (Backport PR #10401, Upstream PR #10386, @pchaigno)
* bpf: remove unused GetProgNextID, GetProgFDByID and GetProgInfoByFD (Backport PR #10286, Upstream PR #10187, @tklauser)
* daemon: Check nodePortMax < ephemeralPortMin in agent (Backport PR #10286, Upstream PR #10260, @brb)
* daemon: create directory with correct permissions in prepareEndpointDirs (Backport PR #10441, Upstream PR #10397, @tklauser)
* datapath/loader: always set all args to bpf/init.sh (Backport PR #10286, Upstream PR #10230, @tklauser)
* doc: Add helm version requirements updated install URL to GKE install guide (Backport PR #10354, Upstream PR #10315, @CybrPunk)
* doc: Adjust documentation to renamed cilium-sysdump tool (Backport PR #10354, Upstream PR #10165, @tgraf)
* doc: Fix links to contributing guide (Backport PR #10401, Upstream PR #10322, @CybrPunk)
* docs: fix inconsistent ipv6 usage in getting started docker docs (Backport PR #10441, Upstream PR #10428, @fristonio)
* Documentation: Lock dependency to fix build (Backport PR #10437, Upstream PR #10419, @Ropes)
* Fix dead link in 1.4->1.5 upgrade documentation (Backport PR #10441, Upstream PR #10416, @Ropes)
* helm: Allow disabling xt_socket fallback (Backport PR #10354, Upstream PR #10342, @brb)
* install: Support generating vX.Y-dev charts (Backport PR #10401, Upstream PR #10355, @joestringer)
* Istio integration has been updated to Istio release 1.4.6. (#10470, @jrajahalme)
* pkg/bpf: Fix KeepAlive usage for pathStr (Backport PR #10354, Upstream PR #10288, @brb)
* test/provision: Fix cilium.provision on running VM (Backport PR #10354, Upstream PR #10301, @pchaigno)
* test: Avoid using global map for Cilium configuration (Backport PR #10401, Upstream PR #10388, @brb)
* Use -F flag in git log in check-stable script (Backport PR #10286, Upstream PR #10283, @nebril)

**Other Changes:**
* 1.7: Fix readme stable releases section (#10444, @joestringer)

## v1.7.0

**Note**: The summary of changes represent the diff between v1.6.6 and v1.7.0

Summary of Changes
------------------

**Major Changes:**
* Add direct server return (DSR) for NodePort BPF (#9473, @brb)
* add support for k8s 1.17 (#9661, @aanm)
* add support for k8s endpoint slice (#9762, @aanm)
* Add support for L7 visibility via pod annotations (#9210, @ianvernon)
* Clusterwide K8s Cilium Network Policies (#9381, @fristonio)
* Envoy TLS support with header imposition (#9486, @jrajahalme)
* operator: add ccnp event watcher to cilium operator (#9669, @fristonio)

**Minor Changes:**
* Add --kube-proxy-replacement flag to control enabling of kube-proxy replacement in BPF (#9992, @brb)
* Add ability to create tags on the ENIs the cilium-operator creates. (#9412, @ungureanuvladvictor)
* Add cilium_version metric (#9623, @ChristineTChen)
* add CLI to introspect state of daemon's `NameManager` field (#9132, @ianvernon)
* Add enable-local-node-route option (#9505, @jraby)
* Add gops to cilium-cni (#9568, @jraby)
* Add more detailed proxy redirects status to `cilium status` (Backport PR #10132, Upstream PR #10082, @joestringer)
* add option to hold cilium agent after init container (Backport PR #10132, Upstream PR #10101, @aanm)
* add support for go modules (#8719, @aanm)
* Add support for HealthCheckNodePort in NodePort BPF (#9906, @gandro)
* Added CRD validation for ciliumnodes.cilium.io (#9655, @ungureanuvladvictor)
* Adding USERS directory to create a list of Cilium users (#9810, @tgraf)
* Adds `--endpoint` argument to `fqdn cache list` to show the cache just for a specific endpoint. (#9334, @ungureanuvladvictor)
* Adds a support for a service of the LoadBalancer type when running Cilium without kube-proxy. (#9694, @brb)
* agent: Mark --lb feature deprecated for removal in 1.7 (#8786, @tgraf)
* Allow icmp fragmentation needed agent option (#8218, @fristonio)
* Allow setting timeout on cilium status command (#9625, @ashrayjain)
* bpf: Add bind{4,6} programs to block NodePorts (#9880, @gandro)
* bpf: improve DumpReliablyWithCallback (#9972, @Rolinh)
* bpf: Report original source IP in TRACE_TO_LXC (#9321, @tgraf)
* cilium cleanup removes previously installed NodePort BPF programs (Backport PR #10072, Upstream PR #10063, @brb)
* cilium: lock GC walks for global CT maps to serialize deletions (#9645, @borkmann)
* clustermesh: Add cilium status section (Backport PR #10212, Upstream PR #10169, @tgraf)
* cmd: add zsh as a option for completion (#9882, @tonyluj)
* Connection-based DNS policy (#9497, @raybejjani)
* daemon,cli: Improve kube-proxy-replacement status (Backport PR #10132, Upstream PR #10083, @brb)
* daemon: Add KubeProxyReplacement to cilium status cmd (Backport PR #10072, Upstream PR #10059, @brb)
* daemon: Fix race condition when syncing services with k8s (#9341, @brb)
* Deprecate/Delete support for monitor v1.0 socket (#9650, @soumynathan)
* docs: bump minimal k8s supported version to v1.11.0 (#9477, @aanm)
* docs: remove disable container runtime documentation (#9868, @aanm)
* docs: Update kube-router getting started guide (Backport PR #10183, Upstream PR #10159, @brb)
* docs: Upgrade about tofqdns-min-ttl default and zombies (#9737, @raybejjani)
* Documentation: Switch EKS documentation to default to ENI (Backport PR #10132, Upstream PR #10126, @tgraf)
* Enable provisioning of K8s services in ipv4 and ipv6 when running in dual-stack mode (#9760, @brb)
* ENI IPAM: Ensure that DeleteOnTermination defaults to true (#9406, @lbernail)
* eni: Allow overwriting AWS instance limit via agent configuration (#9236, @jaffcheng)
* Envoy is updated to release 1.12.1 (#9608, @jrajahalme)
* Fix implementation of k8s external IPs as described in kubernetes documentation (#9092, @aanm)
* Get rid of LB backend weights (#9254, @brb)
* Getting started guide to TLS-visibility (Backport PR #10072, Upstream PR #9808, @danwent)
* golang: update to 1.13.6 (#9872, @aanm)
* golang: update to 1.13.8 (Backport PR #10212, Upstream PR #10179, @aanm)
* HTTPS URL of kube-apiserver can be specified via "--k8s-api-server" from now on. (#9198, @brb)
* Improve monitor aggregation flexibility (#9177, @joestringer)
 Reduce cilium-agent binary size (#9306, @joestringer)
* Introduce identity for remote nodes (#8841, @tgraf)
* ipcache: Add cilium monitor events and expose it via API (#9268, @gandro)
* Istio support is updated to version 1.4.3 (#9968, @jrajahalme)
* k8s: Allow `_` in CNP CRD toFQDNs validation (#9179, @raybejjani)
* kubernetes: Updated connectivity check (Backport PR #10153, Upstream PR #10104, @tgraf)
* logging: add way to configure logging level via cilium-agent option (#8607, @ianvernon)
* Make Agent Prometheus Exporter port configurable (#9584, @Antiarchitect)
* Make FirstInterfaceIndex a pointer on ENI spec (#9745, @ungureanuvladvictor)
* monitor/api: Export map of trace observation points (#9135, @tgraf)
* monitor/api: Export message type names (#9151, @tgraf)
* monitor: Export trace observation point via API (#9119, @tgraf)
* On-demand policy wildcarding (Backport PR #10153, Upstream PR #10054, @jrajahalme)
* pkg/endpoint: add policy visibility status into CiliumEndpoint (#9601, @aanm)
* pkg/k8s: add support for multi-stack (#9215, @aanm)
* pkg/k8s: use local stores to fetch pod information from k8s (#9586, @aanm)
* plugins/cilium-cni: disable CNI debug messages by default (#9493, @aanm)
* policy: Disable well-known identities for non-managed etcd (#9698, @tgraf)
* policy: Reject ingress rules with DNS policies (#8558, @iffyio)
* Relax limits for maximum number of CIDR prefixes (40 -> unlimited) (#9724, @joestringer)
* Remove /96 IPv6 CIDR constraint which makes cilium to work in k8s dual-stack mode (#9777, @brb)
* Remove bpf_lb.c and friends (#9199, @brb)
* Remove container runtime dependencies (#9447, @aanm)
* Rename "Policy denied (L3)" to "Policy denied" (#9951, @tgraf)
* Restrict ENI usage to IPv4 (#8843, @tgraf)
* RFC: k8s / operator: offload CNPNodeStatus updates to cilium-operator (#9384, @ianvernon)
* service: Notify monitor about service updates (#9574, @gandro)
* service: Store and expose service name and namespace (#9554, @gandro)
* ServiceMonitor should default to release namespace (Backport PR #10132, Upstream PR #10088, @dsexton)
* Support for externalTrafficPolicy=Local in NodePort BPF (#9764, @gandro)
* Support v4-in-v6 mapped addresses in BPF host reachable services. (#9923, @borkmann)
* Update to golang 1.13.1 (#9279, @aanm)
* Update to k8s libraries to 1.17.0 (#9744, @aanm)
* Use helm repository in docs (#9783, @ap4y)

**Bugfixes:**
* Add better mechanism to detect if k8s caches are synced against k8s (#9400, @aanm)
* api: Add missing annotations to generate DeepCopy for new status fields (Backport PR #10183, Upstream PR #10166, @tgraf)
* bpf: Fix proxy redirection for egress programs (Backport PR #10153, Upstream PR #10113, @tgraf)
* bpf: Remove POLICY_MAP from bpf_netdev and bpf_overlay (#9949, @tgraf)
* cilium: use %v for dumping frontend struct on error (#9845, @borkmann)
* Correct clustermesh identity sync kvstore backend usage (to actually use the remote) (Backport PR #10212, Upstream PR #10185, @raybejjani)
* daemon: Upgrade spf13/viper (#9796, @raybejjani)
* eni: Check instance existence before resolving deficit (#9676, @jaffcheng)
* Filter out bpftool probes emitting dmesg messages (Backport PR #10183, Upstream PR #10164, @mrostecki)
* Fix cilium daemonset deletion on AKS (#9519, @mlushpenko)
* Fix concurrent access of a variable used for metrics (Backport PR #10183, Upstream PR #10137, @aanm)
* Fix issue (#10092) which incorrectly configured route MTU with encryption and tunnel enabled. (Backport PR #10225, Upstream PR #10218, @jrfastab)
* Fix memory corruption on clusters with IPv6 and NodePort enabled (Backport PR #10212, Upstream PR #10192, @aanm)
* Fix node-port default route detection in case there multiple default entries with same ifindex. (#9844, @borkmann)
* Fix regression to avoid freeing alive IPs (Backport PR #10225, Upstream PR #10207, @tgraf)
* Fix regular service lookup in node-port range in case of host-reachable services. (#9843, @borkmann)
* Fix Unlock handling for kvstore locks (#9973, @aanm)
* Fix vishvananda/netlink library's VethPeerIndex() stack corruption with 4.20+ kernels. (#9588, @borkmann)
* fqdn: Support setting tofqdns-min-ttl to 0 (#9743, @raybejjani)
* health: add ipv6 health check status to cilium health status output (#8766, @fristonio)
* HostToContainer propagation for /sys/fs/bpf (#9575, @jraby)
* ipam: Protect release from releasing alive IP (Backport PR #10072, Upstream PR #10066, @tgraf)
* ipcache: Add probe to check for dump capability to support delete (Backport PR #10153, Upstream PR #10144, @tgraf)
* ipsec: fix connectivity after node reboots (#9866, @martin31821)
* k8s: Fix Service.DeepEquals for ExternalIP (#9690, @brb)
* kubernetes: Disable LocalNodeRoute while chaining (Backport PR #10072, Upstream PR #10057, @tgraf)
* node: Provide context in log when restoring router addresses (#9947, @tgraf)
* operator: only enable kvstore watcher if kvstore is enabled (#9963, @aanm)
* pkg/bpf: Protect each uintptr with runtime.KeepAlive (Backport PR #10212, Upstream PR #10168, @brb)
* pkg/endpoint: access endpoint state safely across go routines (Backport PR #10183, Upstream PR #10140, @aanm)
* pkg/ip: fix cilium status output for big CIDR ranges (#9936, @aanm)
* policy: Don't open localhost when allowing L7 traffic (#9162, @joestringer)
* policy: Expose L3 selectors within endpoint JSON (#8610, @iffyio)

**CI Changes:**
* [CI] add release name to helm template calls (Backport PR #10072, Upstream PR #10062, @nebril)
* [CI] add timeout to vm boot retries (#9816, @nebril)
* [CI] allow to specify focus via GH comment (#9667, @nebril)
* [CI] fallback to binary k8s install (#9271, @nebril)
* [CI] fix /var/log/journal mount in log gatherer (#9668, @nebril)
* [CI] Fix path to print-node-ip script in jenkinsfile (Backport PR #10132, Upstream PR #10112, @nebril)
* [CI] Mark runtime memcache tests as pending (#9955, @nebril)
* [CI] Mark TLS policy test as pending (Backport PR #10225, Upstream PR #10219, @nebril)
* [CI] move docker images to node local registry (#9329, @nebril)
* [CI] Node affinity based on labels not hostname (#9365, @nebril)
* [CI] parallel image build and cluster setup for eks (#9714, @nebril)
* [CI] Retry validating kubeconfig (#9931, @nebril)
* [CI] set $HOME in parallel builds to avoid cache pollution (#9932, @nebril)
* [CI] switch to new HOME only for ginkgo calls (#9971, @nebril)
* Add eks specific jenkinsfile (#9353, @nebril)
* add externalIPs and kube-proxy test matrix (#9849, @aanm)
* Add retry to curl call in basic TLS policy test (#9957, @nebril)
* Add support for running ginkgo tests in microk8s clusters (#9253, @joestringer)
* Add tests for a service annotated with externalTrafficPolicy=Local (#9728, @brb)
* Bump cilium/ubuntu-next version to 42 (#9926, @gandro)
* CI Fixups for EKS (#9675, @raybejjani)
* CI fixups to run on GKE (#9853, @raybejjani)
* CI Fixups to target other runtimes (#9189, @raybejjani)
* CI: Add CNI_INTEGRATION=minikube support (#9261, @raybejjani)
* CI: Add HTTP tests to DatapathConfiguration tests (#9233, @joestringer)
* CI: Delete then create namespaces in policy tests (#9706, @raybejjani)
* CI: Determine and set K8s version in GKE pipeline (#10025, @raybejjani)
* CI: ExecInPods returns an error when no pods are found (#9705, @raybejjani)
* CI: Fix typo setting kubeconfig variable from registry (#9520, @raybejjani)
* CI: Fixups for local runs (#9595, @raybejjani)
* CI: PolicyTest toEntities All (Backport PR #10072, Upstream PR #10051, @raybejjani)
* CI: Set CILIUM_REGISTRY in k8s provisioning scripts (#10006, @gandro)
* CI: Switch WaitforDeamonset/Deploy to shorter poll timeout (#8720, @raybejjani)
* eni: Deep copy CiliumNode resource before storing it in the node (#9893, @jrajahalme)
* Extend bpf verifier tests to test socket programs (#9339, @joestringer)
* Fix service restoration and extend CI for externalTrafficPolicy=Local services (#9778, @gandro)
* Fix upgrade guide for v1.7 and replicate it in a CI test (Backport PR #10153, Upstream PR #9993, @aanm)
* Fixup FQDN tests to run on GKE & EKS (#9990, @raybejjani)
* ginkgo.Jenkinsfile: set k8s nodes back to 2 (#9908, @aanm)
* GKE jenkinsfile (#9876, @nebril)
* Gopkg.toml: update kevinburke/ssh_config dependency (#8689, @kevinburke)
* Move GKE release cluster out of timeout block (#10022, @nebril)
* policy/api: Add tests for reserved:unmanaged match (#8725, @joestringer)
* Remove microscope helpers from testing packages (#9596, @mdevilliers)
* Revert "[CI] add timeout to vm boot retries" (#9967, @aanm)
* Revert "Revert "[CI] add timeout to vm boot retries"" (#9976, @nebril)
* Run CI tests with kube-proxy being disabled (#9901, @brb)
* Set CILIUM_REGISTRY in provisioning scritps (#9991, @nebril)
* Support local testing with one k8s VM. (#9681, @jrajahalme)
* Test against k8s 1.16.2 (#9448, @aanm)
* test/K8sServices: Add Tests for UDP connectivity (Backport PR #10072, Upstream PR #9997, @gandro)
* test/packet: fix packet terraform scripts (#9850, @aanm)
* test: add capability to specify images / skip K8s provisioning (#8748, @ianvernon)
* test: Add conntrack entry timeout validation tests. (#9771, @valas)
* test: Add Kubernetes Service CI tests for IPv6 (Backport PR #10153, Upstream PR #10115, @gandro)
* test: add script which pulls images which have not been pulled during VM provisioning (#8921, @ianvernon)
* test: add some extra narration statements / remove unneeded helper function call (#8846, @ianvernon)
* test: bpf: Fix load for cgroups progs (Backport PR #10183, Upstream PR #10156, @joestringer)
* test: Delete Cilium DS before changing startup options. (#9891, @jrajahalme)
* test: Extend MetalLB test case (#9723, @brb)
* test: Improve skipping of k8sT/Services.go tests (Backport PR #10072, Upstream PR #10047, @brb)
* test: Make helm fetch more quiet (#9799, @joestringer)
* test: Remove cilium DS before installing a new one (Backport PR #10132, Upstream PR #10039, @brb)
* test: remove microscope test (#9075, @ianvernon)
* test: skip installing Helm if user has skipped k8s provisioning (#8835, @ianvernon)
* test: Temporarily disable Istio CI test (#8821, @tgraf)
* tests: test nodeport connectivity via v4-in-v6 sockets (Backport PR #10072, Upstream PR #10053, @borkmann)
* tests: update complexity check script to include new calls (Backport PR #10183, Upstream PR #10106, @fristonio)
* update k8s test versions to 1.14.10, 1.15.7 and 1.16.4 (#9867, @aanm)
* Use proper helm value in CI clusters (#8973, @nebril)
* vagrant: remove unnecessary print statements (#9860, @Rolinh)
* VMs: bump development VM images (#10001, @aanm)

**Misc Changes:**
* .github: add github actions to cilium (#9709, @aanm)
* .github: Clarify release-notes section (#9664, @joestringer)
* .travis: disable go modules when installing dependencies (#9462, @aanm)
* [CI] Fix log gathering (#9267, @nebril)
* add 2020 copyright (#9975, @aanm)
* Add a note on ignoring br_netfilter preflight check (#9229, @bai)
* Add ability to query EC2 ENI instance limits via ec2:DescribeInstanceTypes (#9699, @ungureanuvladvictor)
* Add Adobe to USERS.md (#9852, @dharmab)
* Add alignchecker tests for event notification format (#9426, @joestringer)
* Add cilium-monitor sidecar container for agent pods (#9815, @ap4y)
* add context.Context to Daemon (#9437, @ianvernon)
* Add Datadog to users (#9862, @lbernail)
* Add helm charts packaging steps to the release script (#9772, @ap4y)
* Add MAINTAINERS file (#9598, @tgraf)
* Add Palantir Technologies to USERS.md (#9836, @ungureanuvladvictor)
* Add required etcd version for external etcd guide (Backport PR #10153, Upstream PR #10147, @nebril)
* Add service manager (#9274, @brb)
* Add unit tests for pkg/service.Service (#9289, @brb)
* add uswitch to users.md (#9875, @Joseph-Irving)
* Added support for `restartPods` Helm chart option when running node-init on EKS. (#9740, @tom-hadlaw-hs)
* api/v1: update swagger to v0.20.1 (#9444, @aanm)
* api: Remove remnants of RedirectPort (#9082, @jrajahalme)
* backporting: add 'upstream-prs' tag for code block (#10033, @aanm)
* BPF and XDP reference guide: mention BPF Performance Tools in further readings (#9928, @brandshaide)
* BPF kernel probes based on bpftool (#9789, @mrostecki)
* bpf, nat: initially try snat by preserving source port (#9813, @borkmann)
* bpf, nodeport: add nodeport flag to nodeport services (#9857, @borkmann)
* bpf, sock: fix post-bind-sock{4,6} not found in ELF file (Backport PR #10132, Upstream PR #10124, @borkmann)
* bpf, sock: only attach v6 hooks in v4-only mode when v6 is available (#10027, @borkmann)
* bpf, sock: reduce xlation for externalTrafficPolicy=Local to host_id (#9930, @borkmann)
* bpf: Add unit tests for __ct_lookup() (#9304, @joestringer)
* bpf: Compile bpf_netdev.c with build permutations (#9861, @brb)
* bpf: compile out service lookup entirely on kubeProxyReplacement=disa (Backport PR #10072, Upstream PR #10060, @borkmann)
* bpf: fix sock6_xlate when not all host service protocols are enabled (#9847, @borkmann)
* bpf: Fix space hack in Makefile (Backport PR #10183, Upstream PR #10173, @brb)
* bpf: Get rid of unused lb6_{key,service} structs (#9141, @brb)
* bpf: Remove bpf_netdev.o from previously used devices (Backport PR #10132, Upstream PR #10087, @brb)
* bpf: Remove unused BPF feature probes/macros (#9802, @mrostecki)
* bpf_sock fixes for nodeport (#10014, @borkmann)
* bugtool: Dump NAT BPF maps entries with bpftool (Backport PR #10212, Upstream PR #10190, @brb)
* bump golang to 1.13.3 (#9433, @aanm)
* bump k8s client libraries to v1.17.0-rc.2 (#9713, @aanm)
* charts: Generate versions from VERSION file (Backport PR #10183, Upstream PR #10171, @joestringer)
* CI: Add test for healthCheckNodePort in NodePort BPF (Backport PR #10072, Upstream PR #9977, @gandro)
* cilium: encryption fixes for ipv6 and tear down (#9649, @jrfastab)
* cilium: fix disconnects on operator restarts when using ipsec (#9612, @jrfastab)
* Clean up misc verifier-test.sh functionality (#9325, @joestringer)
* Clean up reference counting of ipcache prefix lengths (#9050, @joestringer)
* Cleanup service.UpsertService method (#9350, @brb)
* cli: Print node list header before the actual list of nodes. (#9295, @ungureanuvladvictor)
* cli: Warn if --rev flag is used with cilium service update (#9319, @brb)
* cmd: replace deprecated Command.SetOutput() (#9881, @tonyluj)
* cni: Try to enable IPv6 only if necessary (#9492, @mrostecki)
* CODEOWNERS: change Vagrant-related files to be owned by cilium/ci (#8788, @ianvernon)
* Connection aware DNS proxy fixups (#9648, @raybejjani)
* contrib/vagrant: change iptables helper message to tcp (#9884, @aanm)
* contrib/vagrant: fix reading VM_MEMORY/VM_CPUS from env vars (#9945, @Rolinh)
* contrib: Fix 'reset' variable declaration (#9559, @joestringer)
* contrib: Update minikube script (#9216, @mrostecki)
* controller: add `Context` to `ControllerParams` (#9500, @ianvernon)
* controller: do not return controller from `UpdateController` (#8894, @ianvernon)
* Correct Contributing link in README (#9060, @cjmakes)
* Correct information about required Go version (#9091, @mrostecki)
* cosmetic: Improve identity / allocator logs (#9662, @joestringer)
* daemon: cancel context for daemon before running cleanup functions (#9487, @ianvernon)
* daemon: Check for no selector update need earlier. (#9396, @jrajahalme)
* daemon: don't hold endpoint BuildMutex while deleting (#8744, @ianvernon)
* daemon: Exit early if NodePort BPF and IPSec is enabled (#9946, @brb)
* daemon: factor out generation of endpoint labels model into `pkg/endpoint` (#8976, @ianvernon)
* daemon: factor out more code into files owned by more specific codeowners (#9122, @ianvernon)
* daemon: fix outdated comment (#9438, @ianvernon)
* daemon: group cleanup-related variables into type (#9524, @ianvernon)
* daemon: make policy repository member of policy get handler (#9440, @ianvernon)
* daemon: misc. cleanup and splitting up of code into separate files (#9048, @ianvernon)
* daemon: move base program compile to loader pkg (#9488, @ianvernon)
* daemon: Move some sysctl writes from bpf/init.sh (#9005, @brb)
* daemon: remove unneeded Daemon field from `RuleReactionEvent` (#9453, @ianvernon)
* datapath: Add DSR IPv6 implementation (#9895, @brb)
* datapath: Do not check rev_nat_id in IPv6 addr (#9952, @brb)
* datapath: Do not return len in find_dsr_v6 (#9933, @brb)
* datapath: make `Datapath` an `IptablesManager` (#9516, @ianvernon)
* datapath: Return error if default route is not found (#9859, @brb)
* dev-vm: update etcd to v3.4.2 and k8s to v1.16.2 (#9463, @aanm)
* dev: set tcp for NFS in development VMs (#9879, @aanm)
* doc: add note about adding the 'kind/backports' label when backporting (#9964, @Rolinh)
* doc: Document L7 limitation in azure-cni chaining mode (Backport PR #10153, Upstream PR #10131, @tgraf)
* doc: Mark encryption as stable for direct-routing and ENI mode (Backport PR #10153, Upstream PR #10142, @tgraf)
* doc: the namespace is wrong when validating cilium on Azure CNI (#9717, @soumynathan)
* doc: update BPF instruction limit (#9727, @florianl)
* doc: update instructions about restarting pods after deployment (Backport PR #10072, Upstream PR #10028, @Rolinh)
* Dockerfile: Bump cilium/iproute2 (#9911, @gandro)
* docs: add etcd related upgrade notes for v1.7 (#9109, @aanm)
* docs: add instructions to update VM images (#9999, @aanm)
* docs: add libelf-devel to development setup (#10032, @tklauser)
* docs: add policy visibility status documentation (#9670, @aanm)
* docs: add section for stable releases to readme (#9131, @borkmann)
* docs: add setup validation howto to kube-proxy-free guide (Backport PR #10132, Upstream PR #10086, @borkmann)
* docs: Describe how to read from tracing pipe (#9665, @joestringer)
* docs: document kube-proxy replacement modes (Backport PR #10072, Upstream PR #10073, @borkmann)
* docs: extend further readings section to a separate file (#9178, @fristonio)
* docs: Fix broken contributing links (#9077, @jaffcheng)
* docs: fix kubernetes configmap (#9824, @aanm)
* docs: fix link for Cilium-PR-Kubernetes-Upstream job (Backport PR #10212, Upstream PR #10178, @tklauser)
* docs: fix spelling issues in clusterwide policy docs (#9602, @fristonio)
* docs: Fix up gke install guide (#10037, @joestringer)
* docs: Fix up nodeport limitations (#9621, @joestringer)
* docs: fixed padding after code blocks (Backport PR #10153, Upstream PR #10143, @geakstr)
* docs: Include env variable in EKS e2e examples (#9726, @raybejjani)
* docs: Keep externalTrafficPolicy=Local limitation in NodePort BPF (#9674, @brb)
* docs: Mention direct routing mode requirement for DSR (Backport PR #10153, Upstream PR #10149, @gandro)
* docs: Minor improvements to GKE guide (Backport PR #10183, Upstream PR #10150, @pchaigno)
* docs: re-wrote wording for the behavior of 'fromEndpoints' (#9544, @aanm)
* docs: revamp kube-proxy-free gsg (Backport PR #10072, Upstream PR #10069, @borkmann)
* docs: update docs for `--aws-release-excess-ips` (#9569, @jaffcheng)
* docs: update supported k8s versions (#9310, @aanm)
* docs: Use kube-system namespace consistently in Encryption guide (Backport PR #10183, Upstream PR #10162, @pchaigno)
* Documentation: add proxy visibility information (#9530, @ianvernon)
* Documentation: add script to add misspelled words (#9578, @aanm)
* Documentation: Document potential conflict of ENI with DHCP agents (#9934, @tgraf)
* Documentation: improve CI documentation organization / remove stale information (#9457, @ianvernon)
* Documentation: Improve external etcd documentation wording (#9478, @mpeiffer)
* Documentation: remove LTS references (#9494, @ianvernon)
* Documentation: remove microscope reference (#9472, @ianvernon)
* Documentation: remove stale GH issue link (#9471, @ianvernon)
* Documentation: split up contributing guide into smaller, more focused documents (#9456, @ianvernon)
* Documentation: update release guide (#9496, @ianvernon)
* Documentation: update to account for new CNPNodeStatus capabilities (#9531, @ianvernon)
* endpoint: clean up exposure of functions / remove unneeded functions (#9121, @ianvernon)
* endpoint: cleanup how build permits are acquired (#9234, @ianvernon)
* endpoint: create distinct type for restoring (#8941, @ianvernon)
* endpoint: create separate interface for proxy (#9157, @ianvernon)
* endpoint: do not export `EventQueue` (#9080, @ianvernon)
* endpoint: do not export `Status` field (#9068, @ianvernon)
* endpoint: do not export additional fields (#9170, @ianvernon)
* endpoint: do not export endpoint locking functions (#9142, @ianvernon)
* endpoint: do not export various fields (#9012, @ianvernon)
* endpoint: factor out waiting for first regeneration during creation into separate function (#9073, @ianvernon)
* endpoint: hide restore operations inside Endpoint package (#8972, @ianvernon)
* endpoint: make policyMap private (#8863, @ianvernon)
* endpoint: move `TestReadEpsFromDirNames` to `pkg/endpoint` (#8997, @ianvernon)
* endpoint: move api-related functions to `api.go` (#8991, @ianvernon)
* endpoint: move deletion deadlock unit test to `pkg/endpoint` (#9067, @ianvernon)
* endpoint: move deletion into Endpoint package, remove acquisition of Endpoint locks in EndpointManager (#9025, @ianvernon)
* endpoint: move patching update functionality to pkg/endpoint (#8968, @ianvernon)
* endpoint: reduce exported functionality (#9191, @ianvernon)
* endpoint: refactor Docker + IPVLAN interactions (#8974, @ianvernon)
* endpoint: refactor how default policy enforcement configuration is performed (#9120, @ianvernon)
* endpoint: refactor proxy-related functioning to not access endpoint mutex directly (#9070, @ianvernon)
* endpoint: remove most cases of direct  access to `OpLabels` (#9069, @ianvernon)
* endpoint: remove need to expose read-locking in `updateEndpointsCaches` (#8977, @ianvernon)
* endpoint: remove unused `HealthCEPPrefix` string (#8896, @ianvernon)
* endpoint: Remove useless restore log message (#9256, @joestringer)
* endpointmanager: add EndpointManager type and remove package-level variables (#8742, @ianvernon)
* endpointmanager: remove unneeded calls to `UpdateLogger` (#9158, @ianvernon)
* eni node_manager unit test improvements (#9756, @jaffcheng)
* Envoy has been updated to release 1.12. (#9542, @jrajahalme)
* Envoy TLS fixes (#9820, @jrajahalme)
* envoy: Use TypedConfig for Envoy filters (#9889, @jrajahalme)
* examples: Remove obsolete k8s-ingress example (#9419, @brb)
* Expands the CiliumNode ENI spec to include `security-group-tags` which allows selecting the security groups associated to the newly created ENI to be filtered by tags. (#9702, @ungureanuvladvictor)
* Extend coverage of connectivity test (Backport PR #10153, Upstream PR #10141, @tgraf)
* factor out conntrack GC into separate package (#9160, @ianvernon)
* Fix configuration of monitor aggregation flags (#9418, @joestringer)
* Fix helm subchart versions (#9826, @ap4y)
* Fix Service6ValueV2 padding and add missing align tags (#9286, @brb)
* Fix table markdown spacing issue (#9801, @dhsathiya)
* fix typo in bpf/lib/lb.h (#9378, @BSWANG)
* Fix typo in documentation (#9739, @vpnachev)
* Fixes #9470: Add clean Makefile target to Documentation (#9506, @rhcu)
* fqdn: Avoid races when updating global cache on GC (#9483, @raybejjani)
* github: remove github actions integration (#9731, @aanm)
* GO_VERSION: set golang version to 1.13.5 (#9761, @aanm)
* golang: update to 1.13.4 (#9565, @aanm)
* golang: update to 1.13.7 (#9985, @aanm)
* health: Quieten health launch log (#9538, @joestringer)
* helm: Add deps for quick-install.yaml target in Makefile (#9759, @brb)
* identity: create `CachingIdentityAllocator ` type (#9066, @ianvernon)
* Improve 1.7 upgrade and nodeport documentation (#9634, @joestringer)
* Improve cilium getEndpointList function (#9240, @fristonio)
* Improve debuggability of custom chain flush/delete (#8692, @joestringer)
* improve kernel probe for host reachable services and fix compile warns (Backport PR #10132, Upstream PR #10111, @borkmann)
* Improve nodeinit uninstalls by reverting nodeinit changes (#9757, @ap4y)
* Improve policy documentation (#9763, @joestringer)
* Improve the 'Setting up Cluster Mesh' page. (#9725, @bmcstdio)
* Improve the uploadrev script (#9787, @joestringer)
* ipcache: Associate IPs with K8s namespace and pod name (#9237, @gandro)
* ipcache: Fix ipcache pod IP update (Backport PR #10132, Upstream PR #10098, @joestringer)
* k8s/types: fix missing deepcopy of SpecPodCIDRs in Node structure (#9239, @aanm)
* k8s: Remove unused types.Ingress (#9701, @brb)
* k8s: update libraries to v1.17.1 (#9883, @aanm)
* kubernetes: Remove obsolete scheduler annotation (#8829, @gandro)
* kvstore: clean up casting around kvstore.Encode (#9138, @borancar)
* kvstore: plumb context (#9512, @ianvernon)
* LB refactoring leftovers (#9320, @brb)
* Lower default FQDN TTLs and update docs (#9653, @raybejjani)
* make: Remove GOPATH from swagger command (#9632, @mrostecki)
* Makefile: add `docker-plugin-image` target (#9315, @ianvernon)
* Makefile: add automated way to update golang in Dockerfiles (#8927, @ianvernon)
* Makefile: add way to skip starting kvstores, running govet (#8758, @ianvernon)
* Makefile: remove deepcopy for configmap (#9098, @aanm)
* Makefile: remove patch for shell script (#9501, @aanm)
* maps: remove configmap (#8895, @ianvernon)
* meta: Combined bpf changes PR for #9323, #9317, #9324 (#9335, @joestringer)
* minor misc doc updates (#9865, @borkmann)
* Minor test documentation / make targets fixups (#9522, @joestringer)
* misc. daemon cleanup (#9498, @ianvernon)
* misc: Get rid of NEWS.rst (#9197, @brb)
* misc: plumb context throughout cilium codebase (#9523, @ianvernon)
* monitor: Add TraceNotify.DataOffset() (#9441, @joestringer)
* Move --aws-instance-limit-mapping flag to be on the operator (#9693, @ungureanuvladvictor)
* Move k8s_watcher.go to pkg/k8s/watchers (#9434, @aanm)
* node: Remove error return from SetIPv6NodeRange (#9954, @tgraf)
* node: Remove unused PublicAttrEquals func (#9758, @joestringer)
* nodediscovery: remove need for `Configuration` interface (#9499, @ianvernon)
* nodeport fixes (#10040, @borkmann)
* nodeport follow-up improvements for nat (#9822, @borkmann)
* operator/cilium-docker: build images with image arguments (#9312, @aanm)
* operator: Improve identity GC logging (#9804, @tgraf)
* pkg/bpf, pkg/endpoint/connector: use RLIM_INFINITY constant (#9283, @tklauser)
* pkg/lock: fix StoppableWaitGroup tests (#9465, @aanm)
* plumb context to policy, aws packages (#9511, @ianvernon)
* plumb daemon's context to various users of context (#9489, @ianvernon)
* policy: clean a duplicated code (Backport PR #10072, Upstream PR #10016, @zhiyuan0x)
* policy: correctly process "ANY" L4 protocol in annotation (#9425, @ianvernon)
* policy: Error out on missing secrets in policy computation (#9897, @jrajahalme)
* policy: generate explicit allow-all at L7 for DNS-based visibility policy (#9391, @ianvernon)
* policy: rename `IsLabelBased` to `AllowsWildcarding` (#9345, @ianvernon)
* pre-flight: set terminationGracePeriodSeconds to 1 (#8952, @ianvernon)
* Prepare for release v1.7.0-rc3 (#10043, @aanm)
* Rate limit ec2:DescribeSubnets in the EC2 client (#9700, @ungureanuvladvictor)
* README: Add link to Hubble (#9639, @gandro)
* README: update latest v1.6 version to v1.6.2 (#9275, @ianvernon)
* README: update released versions of Cilium (#9181, @ianvernon)
* README: update released versions of Cilium (#9373, @ianvernon)
* README: update weekly meeting hours (#9864, @aanm)
* refactor loader into a type and hide it behind Datapath interface (#8769, @ianvernon)
* Refine the clean up scripts for getting started guides (#9629, @denverdino)
* Restore SVC type after restart (#9896, @brb)
* Revert "Makefile: Fix 'make microk8s' privileges" (#9290, @joestringer)
* RFC: Update CODEOWNERS for specific packages and files (#9044, @ianvernon)
* Run make for install/kubernetes/quick-start.yaml (#9751, @frelon)
* SECURITY.md: update versions of supported releases (#9856, @Rolinh)
* service: Remove global ID allocator (#9484, @brb)
* service: Remove optional revNat param and cleanup svc removal (#9227, @brb)
* service: Simplify logic of svc ID allocation (#9213, @brb)
* Small documentation fixes and add release candidate process (#9871, @aanm)
* Supported BPF map types probe based on bpftool (#9795, @mrostecki)
* test README: Fix the documentation link (#9941, @kAworu)
* test: fix ClusterIP IPv6 connectivity checks (Backport PR #10225, Upstream PR #10214, @borkmann)
* test: Fix getNodeInfo in NodePort tests (Backport PR #10225, Upstream PR #10211, @borkmann)
* test: Increase VM provisioning timeout for k8s-1.11 net-next job (#9980, @brb)
* Tidy up backporting documentation (#9560, @joestringer)
* TLS follow-up fixes (#9807, @jrajahalme)
* tools: Add maptool executable to .gitignore (#9420, @brb)
* toops/maptool: run GOCLEAN arguments as part of go clean (#9480, @aanm)
* ubuntu-dev: bump to v164 (#9466, @aanm)
* Unhide --k8s-namespace parameter (#9485, @timoreimann)
* Unit-test wildcard selector equality in rule creation (#9521, @joestringer)
* Update AWS SDK V2 to v0.18.0 (#9770, @ungureanuvladvictor)
* update cilium-runtime with golang 1.13.8 (Backport PR #10225, Upstream PR #10208, @aanm)
* update CODEOWNERS (#10041, @aanm)
* update golang to 1.13.5 (#9749, @aanm)
* Update references to latest releases and projects (#9774, @joestringer)
* update USERS.md: add link to Trip.com's post (#9927, @ArthurChiao)
* update USERS.md: add Trip.com to user list (#9885, @ArthurChiao)
* updates tested k8s version to 1.17.3 (Backport PR #10225, Upstream PR #10215, @aanm)
* use blang/semver for version checking (#9467, @aanm)
* Use config option for security identity swap cool-down period (#9349, @ungureanuvladvictor)
* Use sysctl library and remove redundant sysctl code (#9004, @mrostecki)
* USERS.md: add Sportradar (#9848, @yurrriq)
* vagrant: Install temporary forked bpftool (Backport PR #10212, Upstream PR #10186, @pchaigno)
* vagrant: Remove workaround to MASQ traffic from k8s2 (#9704, @brb)
* vendor: downgrade go-version library due regression (#9459, @aanm)
* vendor: update client-go to kubernetes v1.16.2 (#9445, @aanm)
* workloads: do not set pod name and namespace via workloads plugin (#8999, @ianvernon)
* workloads: remove `WorkloadOwner` from composing `regeneration.Owner` (#9221, @ianvernon)

**Other Changes:**
* .github: rename github-actions file (#9780, @aanm)
* [CI] Increase outer timeout of GKE job (#10009, @nebril)
* [CI] set registry in boot vagrant vms steps (#9618, @nebril)
* [CI] Use LocalExecutor if kubeconfig is defined (#8683, @nebril)
* [Docs] CI bisect documentation (#8782, @nebril)
* bpf, nodeport: fix CT GC race where syn/ack reply gets dropped locally (#9687, @borkmann)
* bump minimum supported kubernetes version to 1.11.0 (#8938, @ianvernon)
* cilium: K8s CI testing for sockops (#9685, @jrfastab)
* contrib: Improve rebase-bindata function (#8702, @joestringer)
* Dockerfile: Use Envoy image that always resumes NPDS (#9635, @jrajahalme)
* docs: Document running via kubeconfig on EKS (#9682, @raybejjani)
* endpoint: Check interface value of proxy field (#9479, @brb)
* eni: Fix AWS ENI allocation exceeding IP limits for smaller instances (#9732, @huntermassey)
* Fix 'make microk8s' target (#8984, @joestringer)
* fqdn: Add zombie limit (#9641, @raybejjani)
* Improve Getting Started guides by provide next steps sections (#9679, @genbit)
* lxcmap: refactor `EndpointFrontend` interface (#8877, @ianvernon)
* node/manager: Lock nodes slice during Subscribe (#9495, @joestringer)
* Prepare for release v1.7.0-rc4 (#10170, @joestringer)
* Prepare for v1.7 development (#8653, @ianvernon)
* readme: update info for latest stable branch releases (#9688, @borkmann)
* Revert "test: Temporarily disable Istio CI test" (#8844, @ianvernon)
* test: Add `vagrant-local-start.sh` with preloaded VM support (#9633, @jrajahalme)
* test: Install CoreDNS after Cilium is up (#8772, @tgraf)
* test: Support external DNS lookups also for k8s-1.16 (#9666, @jrajahalme)
* Update GO_VERSION to match builder version (#9995, @ap4y)
* Update USERS.md to include Rapyuta Robotics (#9909, @HackToHell)
* Updating AUTHORS (#9637, @aanm)
* Updating USERS.md to include CENGN (#9942, @mohahmed13)
* vendor: update etcd to v3.4.2 (#9461, @aanm)

## v1.7.0-rc4

Summary of Changes
------------------

**Minor Changes:**
* cilium cleanup removes previously installed NodePort BPF programs (Backport PR #10072, Upstream PR #10063, @brb)
* Getting started guide to TLS-visibility (Backport PR #10072, Upstream PR #9808, @danwent)
* daemon: Add KubeProxyReplacement to cilium status cmd (Backport PR #10072, Upstream PR #10059, @brb)
* add option to hold cilium agent after init container (Backport PR #10132, Upstream PR #10101, @aanm)
* daemon,cli: Improve kube-proxy-replacement status (Backport PR #10132, Upstream PR #10083, @brb)
* Add more detailed proxy redirects status to `cilium status` (Backport PR #10132, Upstream PR #10082, @joestringer)
* ServiceMonitor should default to release namespace (Backport PR #10132, Upstream PR #10088, @dsexton)
* Documentation: Switch EKS documentation to default to ENI (Backport PR #10132, Upstream PR #10126, @tgraf)
* kubernetes: Updated connectivity check (Backport PR #10153, Upstream PR #10104, @tgraf)
* On-demand policy wildcarding (Backport PR #10153, Upstream PR #10054, @jrajahalme)

**Bugfixes:**
* kubernetes: Disable LocalNodeRoute while chaining (Backport PR #10072, Upstream PR #10057, @tgraf)
* ipam: Protect release from releasing alive IP (Backport PR #10072, Upstream PR #10066, @tgraf)
* ipcache: Add probe to check for dump capability to support delete (Backport PR #10153, Upstream PR #10144, @tgraf)
* bpf: Fix proxy redirection for egress programs (Backport PR #10153, Upstream PR #10113, @tgraf)

**CI Changes:**
* tests: test nodeport connectivity via v4-in-v6 sockets (Backport PR #10072, Upstream PR #10053, @borkmann)
* test/K8sServices: Add Tests for UDP connectivity (Backport PR #10072, Upstream PR #9997, @gandro)
* [CI] add release name to helm template calls (Backport PR #10072, Upstream PR #10062, @nebril)
* test: Improve skipping of k8sT/Services.go tests (Backport PR #10072, Upstream PR #10047, @brb)
* CI: PolicyTest toEntities All (Backport PR #10072, Upstream PR #10051, @raybejjani)
* test: Remove cilium DS before installing a new one (Backport PR #10132, Upstream PR #10039, @brb)
* [CI] Fix path to print-node-ip script in jenkinsfile (Backport PR #10132, Upstream PR #10112, @nebril)
* test: Add Kubernetes Service CI tests for IPv6 (Backport PR #10153, Upstream PR #10115, @gandro)
* Fix upgrade guide for v1.7 and replicate it in a CI test (Backport PR #10153, Upstream PR #9993, @aanm)

**Misc Changes:**
* bpf: compile out service lookup entirely on kubeProxyReplacement=disa (Backport PR #10072, Upstream PR #10060, @borkmann)
* docs: revamp kube-proxy-free gsg (Backport PR #10072, Upstream PR #10069, @borkmann)
* docs: document kube-proxy replacement modes (Backport PR #10072, Upstream PR #10073, @borkmann)
* CI: Add test for healthCheckNodePort in NodePort BPF (Backport PR #10072, Upstream PR #9977, @gandro)
* doc: update instructions about restarting pods after deployment (Backport PR #10072, Upstream PR #10028, @Rolinh)
* policy: clean a duplicated code (Backport PR #10072, Upstream PR #10016, @zhiyuan0x)
* ipcache: Fix ipcache pod IP update (Backport PR #10132, Upstream PR #10098, @joestringer)
* improve kernel probe for host reachable services and fix compile warns (Backport PR #10132, Upstream PR #10111, @borkmann)
* bpf, sock: fix post-bind-sock{4,6} not found in ELF file (Backport PR #10132, Upstream PR #10124, @borkmann)
* bpf: Remove bpf_netdev.o from previously used devices (Backport PR #10132, Upstream PR #10087, @brb)
* docs: add setup validation howto to kube-proxy-free guide (Backport PR #10132, Upstream PR #10086, @borkmann)
* docs: fixed padding after code blocks (Backport PR #10153, Upstream PR #10143, @geakstr)
* doc: Mark encryption as stable for direct-routing and ENI mode (Backport PR #10153, Upstream PR #10142, @tgraf)
* doc: Document L7 limitation in azure-cni chaining mode (Backport PR #10153, Upstream PR #10131, @tgraf)
* docs: Mention direct routing mode requirement for DSR (Backport PR #10153, Upstream PR #10149, @gandro)
* Extend coverage of connectivity test (Backport PR #10153, Upstream PR #10141, @tgraf)
* Add required etcd version for external etcd guide (Backport PR #10153, Upstream PR #10147, @nebril)


## v1.7.0-rc3

Summary of Changes
------------------

**Major Changes:**
* Add direct server return (DSR) for NodePort BPF (#9473, @brb)
* add support for k8s endpoint slice (#9762, @aanm)

**Minor Changes:**
* cmd: add zsh as a option for completion (#9882, @tonyluj)
* golang: update to 1.13.6 (#9872, @aanm)
* docs: remove disable container runtime documentation (#9868, @aanm)
* bpf: improve DumpReliablyWithCallback (#9972, @Rolinh)
* Istio support is updated to version 1.4.3 (#9968, @jrajahalme)
* Use helm repository in docs (#9783, @ap4y)
* Rename "Policy denied (L3)" to "Policy denied" (#9951, @tgraf)
* Add support for HealthCheckNodePort in NodePort BPF (#9906, @gandro)
* bpf: Add bind{4,6} programs to block NodePorts (#9880, @gandro)
* Support v4-in-v6 mapped addresses in BPF host reachable services. (#9923, @borkmann)
* Add --kube-proxy-replacement flag to control enabling of kube-proxy replacement in BPF (#9992, @brb)

**Bugfixes:**
* operator: only enable kvstore watcher if kvstore is enabled (#9963, @aanm)
* Fix Unlock handling for kvstore locks (#9973, @aanm)
* Fix regular service lookup in node-port range in case of host-reachable services. (#9843, @borkmann)
* ipsec: fix connectivity after node reboots (#9866, @martin31821)
* cni: Fix IP leak when CNI ADD times out (#9913, @tgraf)
* Fix cilium-operator deadlock for clusters with more than 128 services (#10010, @aanm)
* Fix node-port default route detection in case there multiple default entries with same ifindex. (#9844, @borkmann)
* eni: Fix releases of excess IPs (#9858, @tgraf)
* cni: Fix noisy warning "Unknown CNI chaining configuration" (#9937, @tgraf)
* cilium: use %v for dumping frontend struct on error (#9845, @borkmann)
* pkg/ip: fix cilium status output for big CIDR ranges (#9936, @aanm)
* Fix cilium installation in GCloud beta "rapid" channel (#9959, @joestringer)
* node: Provide context in log when restoring router addresses (#9947, @tgraf)
* bpf: Remove POLICY_MAP from bpf_netdev and bpf_overlay (#9949, @tgraf)
* garbage collect stale distributed locks (#9982, @aanm)

**CI Changes:**
* test/packet: fix packet terraform scripts (#9850, @aanm)
* [CI] set $HOME in parallel builds to avoid cache pollution (#9932, @nebril)
* [CI] Mark runtime memcache tests as pending (#9955, @nebril)
* Revert "Revert "[CI] add timeout to vm boot retries"" (#9976, @nebril)
* Add retry to curl call in basic TLS policy test (#9957, @nebril)
* Move GKE release cluster out of timeout block (#10022, @nebril)
* [CI] switch to new HOME only for ginkgo calls (#9971, @nebril)
* Fixup FQDN tests to run on GKE & EKS (#9990, @raybejjani)
* test: Delete Cilium DS before changing startup options. (#9891, @jrajahalme)
* vagrant: remove unnecessary print statements (#9860, @Rolinh)
* Revert "[CI] add timeout to vm boot retries" (#9967, @aanm)
* ginkgo.Jenkinsfile: set k8s nodes back to 2 (#9908, @aanm)
* VMs: bump development VM images (#10001, @aanm)
* add externalIPs and kube-proxy test matrix (#9849, @aanm)
* GKE jenkinsfile (#9876, @nebril)
* Bump cilium/ubuntu-next version to 42 (#9926, @gandro)
* CI fixups to run on GKE (#9853, @raybejjani)
* Set CILIUM_REGISTRY in provisioning scritps (#9991, @nebril)
* CI: Determine and set K8s version in GKE pipeline (#10025, @raybejjani)
* [CI] add timeout to vm boot retries (#9816, @nebril)
* eni: Deep copy CiliumNode resource before storing it in the node (#9893, @jrajahalme)
* Run CI tests with kube-proxy being disabled (#9901, @brb)
* CI: Set CILIUM_REGISTRY in k8s provisioning scripts (#10006, @gandro)
* update k8s test versions to 1.14.10, 1.15.7 and 1.16.4 (#9867, @aanm)
* [CI] Retry validating kubeconfig (#9931, @nebril)

**Misc Changes:**
* USERS.md: add Sportradar (#9848, @yurrriq)
* contrib/vagrant: change iptables helper message to tcp (#9884, @aanm)
* README: update weekly meeting hours (#9864, @aanm)
* doc: add note about adding the 'kind/backports' label when backporting (#9964, @Rolinh)
* docs: add instructions to update VM images (#9999, @aanm)
* Fix GC Locks bugs (#10005, @aanm)
* contrib/vagrant: fix reading VM_MEMORY/VM_CPUS from env vars (#9945, @Rolinh)
* datapath: Do not check rev_nat_id in IPv6 addr (#9952, @brb)
* eni node_manager unit test improvements (#9756, @jaffcheng)
* test: Increase VM provisioning timeout for k8s-1.11 net-next job (#9980, @brb)
* nodeport fixes (#10040, @borkmann)
* datapath: Add DSR IPv6 implementation (#9895, @brb)
* bpf_sock fixes for nodeport (#10014, @borkmann)
* Update release process steps (#10035, @aanm)
* dev: set tcp for NFS in development VMs (#9879, @aanm)
* bpf, nodeport: add nodeport flag to nodeport services (#9857, @borkmann)
* Add Datadog to users (#9862, @lbernail)
* update USERS.md: add Trip.com to user list (#9885, @ArthurChiao)
* k8s: update libraries to v1.17.1 (#9883, @aanm)
* Dockerfile: Bump cilium/iproute2 (#9911, @gandro)
* add uswitch to users.md (#9875, @Joseph-Irving)
* Add cilium-monitor sidecar container for agent pods (#9815, @ap4y)
* minor misc doc updates (#9865, @borkmann)
* docs: add libelf-devel to development setup (#10032, @tklauser)
* datapath: Do not return len in find_dsr_v6 (#9933, @brb)
* Add Palantir Technologies to USERS.md (#9836, @ungureanuvladvictor)
* SECURITY.md: update versions of supported releases (#9856, @Rolinh)
* daemon: Exit early if NodePort BPF and IPSec is enabled (#9946, @brb)
* Supported BPF map types probe based on bpftool (#9795, @mrostecki)
* Add Adobe to USERS.md (#9852, @dharmab)
* Restore SVC type after restart (#9896, @brb)
* docs: Fix up gke install guide (#10037, @joestringer)
* update USERS.md: add link to Trip.com's post (#9927, @ArthurChiao)
* Small documentation fixes and add release candidate process (#9871, @aanm)
* Misc project maintenance updates (#10042, @aanm)
* bpf: Compile bpf_netdev.c with build permutations (#9861, @brb)
* bpf, sock: reduce xlation for externalTrafficPolicy=Local to host_id (#9930, @borkmann)
* Envoy TLS fixes (#9820, @jrajahalme)
* backporting: add 'upstream-prs' tag for code block (#10033, @aanm)
* datapath: Return error if default route is not found (#9859, @brb)
* cmd: replace deprecated Command.SetOutput() (#9881, @tonyluj)
* Fix helm subchart versions (#9826, @ap4y)
* node: Remove error return from SetIPv6NodeRange (#9954, @tgraf)
* nodeinit/templates: fix indentation of sys-fs-bpf (#10008, @aanm)
* Added support for `restartPods` Helm chart option when running node-init on EKS. (#9740, @tom-hadlaw-hs)
* bpf: fix sock6_xlate when not all host service protocols are enabled (#9847, @borkmann)
* bpf, sock: only attach v6 hooks in v4-only mode when v6 is available (#10027, @borkmann)
* policy: Error out on missing secrets in policy computation (#9897, @jrajahalme)
* golang: update to 1.13.7 (#9985, @aanm)
* add 2020 copyright (#9975, @aanm)
* Documentation: Document potential conflict of ENI with DHCP agents (#9934, @tgraf)
* envoy: Use TypedConfig for Envoy filters (#9889, @jrajahalme)
* BPF and XDP reference guide: mention BPF Performance Tools in further readings (#9928, @brandshaide)
* test README: Fix the documentation link (#9941, @kAworu)

**Other Changes:**
* Update GO_VERSION to match builder version (#9995, @ap4y)
* [CI] Increase outer timeout of GKE job (#10009, @nebril)
* Update USERS.md to include Rapyuta Robotics (#9909, @HackToHell)
* Updating USERS.md to include CENGN (#9942, @mohahmed13)
